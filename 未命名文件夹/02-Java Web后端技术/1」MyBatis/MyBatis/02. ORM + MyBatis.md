```ActivityHistory
/
```
## ORM

- [>]  å¯¹è±¡å…³ç³»æ˜ å°„
- [>]  `Object Relational Mapping` 

```ad-important

Oï¼ˆå¯¹è±¡æ¨¡å‹ï¼‰ï¼š
	
	å®ä½“å¯¹è±¡

	ç¨‹åºä¸­æ ¹æ®æ•°æ®åº“è¡¨ç»“æ„å»ºç«‹çš„ä¸€ä¸ªä¸ªå®ä½“ javaBean	

Rï¼ˆå…³ç³»å‹æ•°æ®åº“çš„æ•°æ®ç»“æ„ï¼‰ï¼š
	
	æ•°æ®åº“è¡¨

	å…³ç³»æ•°æ®åº“é¢†åŸŸçš„Relationalï¼ˆå»ºç«‹çš„æ•°æ®åº“è¡¨ï¼‰

Mï¼ˆæ˜ å°„ï¼‰ï¼š
	
	å°†å®ä½“å¯¹è±¡ä¸æ•°æ®åº“è¡¨å»ºç«‹æ˜ å°„å…³ç³»

	ä»Rï¼ˆæ•°æ®åº“ï¼‰åˆ°Oï¼ˆå¯¹è±¡æ¨¡å‹ï¼‰çš„æ˜ å°„ï¼Œå¯é€šè¿‡XMLæ–‡ä»¶æ˜ å°„
```




  

## question

æ€ä¹ˆå°†å®ä½“å¯¹è±¡å’Œæ•°æ®åº“è¡¨å»ºç«‹æ˜ å°„å…³ç³»ï¼Ÿ

Mæ˜ å°„æ€ä¹ˆå®Œæˆï¼Ÿ
  
  

## æ˜ å°„

  

- ï¼ˆ1ï¼‰è®©å®ä½“ç±»å’Œæ•°æ®åº“è¡¨è¿›è¡Œä¸€ä¸€å¯¹åº”å…³ç³»

  

å…ˆè®© å®ä½“ç±» å’Œ æ•°æ®åº“è¡¨ å¯¹åº”

å†è®© å®ä½“ç±»å±æ€§ å’Œ è¡¨é‡Œé¢å­—æ®µ å¯¹åº”

  

- ï¼ˆ2ï¼‰ä¸éœ€è¦ç›´æ¥æ“ä½œæ•°æ®åº“è¡¨ï¼Œç›´æ¥æ“ä½œè¡¨å¯¹åº”çš„å®ä½“ç±»å¯¹è±¡


# Mybatis
### å¼€å‘æ­¥éª¤

```ad-need
é€šè¿‡mybatis æŸ¥è¯¢æ•°æ®åº“ userè¡¨çš„æ‰€æœ‰è®°å½•

å°è£…åˆ°Userå¯¹è±¡ä¸­

æ‰“å°åˆ°æ§åˆ¶å°ä¸Š
```


```ad-todo
1.  åˆ›å»ºæ•°æ®åº“åŠuserè¡¨
    
2.  åˆ›å»ºmavenå·¥ç¨‹ï¼Œå¯¼å…¥ä¾èµ–ï¼ˆMySQLé©±åŠ¨ã€mybatisã€junitï¼‰
    
3.  ç¼–å†™ <mark style="background: #6FE26FA6;">Userå®ä½“ç±»</mark> ï¼Œå¯¹åº”å±æ€§æœ‰Get/Setæ–¹æ³•
    
4.  ç¼–å†™ <mark style="background: #6FE26FA6;">UserMapper.xml</mark> æ˜ å°„é…ç½®æ–‡ä»¶ï¼ˆORMæ€æƒ³ï¼‰
    
5.  ç¼–å†™ <mark style="background: #6FE26FA6;">sqlMapConfig.xml</mark> æ ¸å¿ƒé…ç½®æ–‡ä»¶

	1. æ•°æ®åº“ç¯å¢ƒé…ç½®

	2. æ˜ å°„å…³ç³»é…ç½®çš„å¼•å…¥(å¼•å…¥æ˜ å°„é…ç½®æ–‡ä»¶çš„è·¯å¾„)

6.  ç¼–å†™æµ‹è¯•ä»£ç 
```
```ad-question
æ˜ å°„é…ç½®æ–‡ä»¶ä¸€å®šæ˜¯UserMapper.xmlï¼Ÿï¼Ÿ
ä¸ºä»€ä¹ˆè¦æœ‰æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Ÿï¼Ÿ
```



>
```ad-seealso
æ˜ å°„é…ç½®æ–‡ä»¶å‘½åè§„åˆ™ä¸º ï¼šå®ä½“ç±»å+Mapper.xml


>æ¯ä¸€ä¸ªæ¡†æ¶éƒ½æœ‰è‡ªå·±çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ŒSqlMapConfig.xmlä¸ºçº¦å®šé…ç½®æ–‡ä»¶å


æ ¸å¿ƒé…ç½®æ–‡ä»¶é‡Œé¢å¼•å…¥æ˜ å°„é…ç½®æ–‡ä»¶
```


#### 2. å¯¼åŒ…
```xml

    <!--æŒ‡å®šç¼–ç å’Œç‰ˆæœ¬-->  
    <properties>  
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>  
        <maven.compiler.encoding>UTF-8</maven.compiler.encoding>  
        <java.version>1.11</java.version>  
        <maven.compiler.source>1.11</maven.compiler.source>  
        <maven.compiler.target>1.11</maven.compiler.target>  
    </properties>  
  
    <!--å¼•å…¥ç›¸å…³ä¾èµ–-->  
    <dependencies>  
        <!--mybatisåæ ‡-->  
        <dependency>  
            <groupId>org.mybatis</groupId>  
            <artifactId>mybatis</artifactId>  
            <version>3.5.9</version>  
        </dependency>  
  
  
        <dependency>  
            <groupId>org.junit.jupiter</groupId>  
            <artifactId>junit-jupiter-api</artifactId>  
            <version>5.8.2</version>  
            <scope>test</scope>  
        </dependency>  
        <dependency>  
            <groupId>org.projectlombok</groupId>  
            <artifactId>lombok</artifactId>  
            <version>RELEASE</version>  
            <scope>compile</scope>  
        </dependency>  
        <!-- mysqlè¿æ¥ -->  
        <dependency>  
            <groupId>mysql</groupId>  
            <artifactId>mysql-connector-java</artifactId>  
            <version>8.0.28</version>  
  
        </dependency>  
  
    </dependencies>  

```


#### 3. å®ä½“ç±»
```java
package top.testeru.domain;

import lombok.Getter;
import lombok.Setter;
import lombok.ToString;

import java.time.LocalDateTime;


@Getter
@Setter
@ToString
public class TestUser{
    
    /**
     * ä¸»é”®
     */
    private Integer id;

    /**
     * ç”¨æˆ·å
     */
    private String userName;

    /**
     * å¯†ç 
     */
    private String password;

    /**
     * é‚®ç®±
     */
    private String email;

    /**
     * è‡ªåŠ¨ç”Ÿæˆç”¨ä¾‹jobåç§° ä¸ä¸ºç©ºæ—¶è¡¨ç¤ºå·²ç»åˆ›å»ºjob
     */
    private String autoCreateCaseJobName;

    /**
     * æ‰§è¡Œæµ‹è¯•jobåç§° ä¸ä¸ºç©ºæ—¶è¡¨ç¤ºå·²ç»åˆ›å»ºjob
     */
    private String startTestJobName;

    /**
     * é»˜è®¤JenkinsæœåŠ¡å™¨
     */
    private Integer defaultJenkinsId;

    /**
     * åˆ›å»ºæ—¶é—´
     */
    private LocalDateTime createTime;

    /**
     * æ›´æ–°æ—¶é—´
     */
    private LocalDateTime updateTime;


}


```



#### 4. æ˜ å°„é…ç½®
`````ad-note

1. <mark style="background: #6FE26FA6;">UserMapper.xml</mark>  å†™ mapper æ ‡ç­¾å†…çš„sqlè¯­å¥ä¸ç”¨åŠ ç»“å°¾<mark style="background: #6FE26FA6;">;</mark> 

2. æ€ä¹ˆå®šä½å†™çš„sqlè¯­å¥ï¼Ÿ 

	1. <mark style="background: #6FE26FA6;">select</mark> æ ‡ç­¾çš„ <mark style="background: #6FE26FA6;">id</mark>  å±æ€§å°±æ˜¯å¯¹åº”å½“å‰xmlæ–‡ä»¶ä¸‹çš„sqlè¯­å¥çš„æ ‡è¯† 
	
	2. ã€Œä½†æ˜¯å¤šä¸ªxmlæ–‡ä»¶æœ‰ç›¸åŒidæ€ä¹ˆå®šä½ï¼Ÿã€
	
	3. <mark style="background: #6FE26FA6;">mapper</mark> æ ‡ç­¾ä¸Šæ·»åŠ <mark style="background: #6FE26FA6;">namespace</mark> å±æ€§

3. æŸ¥è¯¢ç»“æœè¿”å›ç»™å®ä½“ç±»

	1. <mark style="background: #6FE26FA6;">select</mark> æ ‡ç­¾çš„ <mark style="background: #6FE26FA6;">resultType</mark>  å±æ€§å°±æ˜¯è¿”å›ç»“æœç±»å‹å£°æ˜

	2. resultType å¯¹åº”çš„å€¼ä¸ºå®ä½“ç±»çš„å…¨è·¯å¾„ --> åŒ…å.ç±»å

	3. æ ¹æ®<mark style="background: #6FE26FA6;">æ•°æ®åº“çš„å­—æ®µå</mark>å’Œ<mark style="background: #6FE26FA6;">å®ä½“ç±»å±æ€§å</mark>çš„å¯¹åº”å…³ç³»ï¼Œè°ƒç”¨setæ–¹æ³•æ¥è‡ªåŠ¨å®Œæˆæ˜ å°„å°è£…
`````

```xml
<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
  
<!--namespace å‘½åç©ºé—´ï¼Œä¸IDå±æ€§å…±åŒæ„æˆå”¯ä¸€æ ‡è¯†  namespace.id  user.findAll -->  
<mapper namespace="user">  
<!--resultTypeï¼šè¿”å›ç»“æœç±»å‹ï¼Œå®Œæˆè‡ªåŠ¨æ˜ å°„å°è£…  -> è¦å°è£…çš„å®ä½“å…¨è·¯å¾„    -->  
    <select id="findAll" resultType="top.testeru.domain.TestUser">  
         select * from test_user    </select>  
</mapper>
```
#### 5. æ ¸å¿ƒé…ç½®
##### 1. æ•°æ®åº“ç¯å¢ƒé…ç½®
```ad-note
1. æ ¸å¿ƒé…ç½®æ–‡ä»¶çš„çº¦æŸå¤´å’Œæ˜ å°„é…ç½®æ–‡ä»¶çš„çº¦æŸå¤´ä¸ä¸€æ ·

2. æ ¸å¿ƒé…ç½®æ–‡ä»¶çš„æ ¹æ ‡ç­¾æ˜¯ <mark style="background: #6FE26FA6;">configuration</mark>

3. é¦–å…ˆé…ç½®è¿è¡Œç¯å¢ƒ
	
	 <mark style="background: #6FE26FA6;">environment</mark> è¿è¡Œç¯å¢ƒæœ‰å¤šç§ï¼šç”Ÿäº§ç¯å¢ƒã€å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç°åº¦ 
	 
4.  å¯¹<mark style="background: #00ffff;">äº‹åŠ¡ç®¡ç†å™¨</mark>è¿›è¡Œé…ç½®
	 <mark style="background: #6FE26FA6;">transactionManager</mark>ï¼šJDBCã€Œå½“å‰çš„äº‹åŠ¡äº¤ç”±JDBCç®¡ç†ã€

	  >mybatisæ˜¯ä¸€ä¸ªæŒä¹…å±‚æ¡†æ¶ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼›
	  å¯¹å…³ç³»å‹æ•°æ®åº“è¿›è¡Œæ“ä½œçš„æ—¶å€™è‚¯å®šé¿å…ä¸äº†äº‹åŠ¡çš„å¤„ç†

5. æ˜¯å¦ä½¿ç”¨  <mark style="background: #00ffff;">è¿æ¥æ± </mark>
	<mark style="background: #6FE26FA6;">dataSource</mark>ï¼šPOOLEDã€Œä½¿ç”¨mybatisè¿æ¥æ± ã€

6. æ•°æ®åº“è¿æ¥é…ç½®<mark style="background: #6FE26FA6;">property</mark>
	<mark style="background: #00ffff;">driver</mark>ã€<mark style="background: #00ffff;">url</mark>ã€<mark style="background: #00ffff;">username</mark>ã€<mark style="background: #00ffff;">password</mark>

```

##### 2. æ˜ å°„å…³ç³»é…ç½®çš„å¼•å…¥

```ad-note
1. ä½¿ç”¨mappersæ ‡ç­¾ğŸ·ï¸è¿›è¡Œå¼•å…¥

2. æ¯ä¸€ä¸ª<mark style="background: #00ffff;">mapperæ ‡ç­¾</mark>å°±æ˜¯ä¸€ä¸ª<mark style="background: #6FE26FA6;">*mapper.xml</mark>æ–‡ä»¶

3. <mark style="background: #6FE26FA6;">resource</mark> ä½¿ç”¨çš„æ˜¯mapperæ–‡ä»¶çš„å…¨è·¯å¾„
	

```


- sqlMapConfig.xml
```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd">
<configuration>
    <environments default="dev">
        <!--devï¼šdevelopment   ç”Ÿäº§/å¼€å‘ç¯å¢ƒ-->
        <environment id="dev">
            <!-- transactionManager äº‹åŠ¡ç®¡ç†å™¨   å½“å‰çš„äº‹åŠ¡ç®¡ç†å™¨æ˜¯JDBC-->
            <transactionManager type="JDBC"></transactionManager>
            <!-- æ•°æ®æºä¿¡æ¯  POOLEDï¼šä½¿ç”¨mybatisè¿æ¥æ±      UNPOOLEDï¼šä¸ä½¿ç”¨mybatisè¿æ¥æ± ï¼Œæ¯æ¬¡è·å–éƒ½æ˜¯æ–°çš„è¿æ¥ -->
            <dataSource type="POOLED">
            <!--é…ç½®æ•°æ®åº“çš„è¿æ¥çš„ä¸€äº›å±æ€§-->
                <!--nameéƒ½æ˜¯å›ºå®šçš„-->
                <property name="driver" value="com.mysql.cj.jdbc.Driver"/>
                <property name="url" value="jdbc:mysql://110.40.250.165:3307/turorials?characterEncoding=UTF-8&useUnicode=true&useSSL=false&serverTimezone=GMT"/>
                <property name="username" value="root"/>
                <property name="password" value="root"/>
            </dataSource>
        </environment>
        <!--qaï¼š   æµ‹è¯•ç¯å¢ƒ-->
        <environment id="qa">
            <!-- transactionManager äº‹åŠ¡ç®¡ç†å™¨           -->
            <transactionManager type="JDBC"></transactionManager>
            <dataSource type="POOLED"></dataSource>
        </environment>
    </environments>

<!-- 2ã€æ˜ å°„å…³ç³»é…ç½®çš„å¼•å…¥-->  
    <mappers>  
        <mapper resource="mapper/UserMapper.xml"></mapper>  
    </mappers>

</configuration>
```

#### 6. æµ‹è¯•ä»£ç 

```ad-note
1. åŠ è½½æ ¸å¿ƒé…ç½®æ–‡ä»¶  
2. è·å–sqlSessionFactoryå·¥å‚å¯¹è±¡  
3. è·å–sqlSessionä¼šè¯å¯¹è±¡  
4. æ‰§è¡Œsql  
5. æ‰“å°ç»“æœ  
6. é‡Šæ”¾èµ„æº
```



```java


package top.testeru.jdbc;

import org.apache.ibatis.io.Resources;
import org.junit.jupiter.api.Test;
import top.testeru.domain.mybatis.MybatisDemo;

import java.io.IOException;


public class MyBatisTest {

    @Test
    void test() throws IOException {
        MybatisDemo mybatisDemo = new MybatisDemo();
        mybatisDemo.quickStart();


    }
}

```





`````ad-bug
title: Bug-1
color: 64, 255, 0



```note-red 
<property name="url" value="jdbc:mysql://110.40.250.165:3307/turorials?characterEncoding=UTF-8&useUnicode=true&useSSL=false&serverTimezone=GMT"/>

```

```note-red-bg
BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 15; columnNumber: 122; å¯¹å®ä½“ "useUnicode" çš„å¼•ç”¨å¿…é¡»ä»¥ ';' åˆ†éš”ç¬¦ç»“å°¾ã€‚
```
    
`````



```````ad-warning
title: è§£å†³


```note-red 
&amp;
```
æ›¿æ¢åŸæ¥çš„`&`




```````





`````ad-bug
title: Bug-2

```note-red 
org.apache.ibatis.exceptions.PersistenceException: 

 Error querying database.  Cause: java.lang.IllegalArgumentException: 
```

```note-red-bg
Mapped Statements collection does not contain value for user.findAll 
```

`````



```````ad-warning
title: è§£å†³

åªåŠ è½½äº†
```note-red 
sqlMapConfig.xml
```
æ²¡æœ‰åŠ è½½mapperçš„é…ç½®æ–‡ä»¶ï¼Œæ‰¾ä¸åˆ° `user.findAll`


```note-red-bg
sqlMapConfig.xmlä¸­å¼•å…¥é…ç½®æ–‡ä»¶
```

```````


### å°ç»“

`````ad-note

1. ```note-red 
	åˆ›å»ºmybatis_dbæ•°æ®åº“å’Œuserè¡¨
	```
2. ```note-red 
	åˆ›å»ºé¡¹ç›®ï¼Œå¯¼å…¥ä¾èµ–
	```
3. ```note-red 
	åˆ›å»ºUserå®ä½“ç±»
	```
	å®ä½“ç±»å’Œæ•°æ®åº“è¡¨çš„åˆ—åä¸€ä¸€å¯¹åº”
	
4. ```note-red 
	ç¼–å†™æ˜ å°„æ–‡ä»¶UserMapper.xml
	```
5. ```note-red 
	ç¼–å†™æ ¸å¿ƒæ–‡ä»¶SqlMapConfig.xml
	```
	SqlMapConfig.xml è¦å¼•å…¥å¯¹åº”çš„mapper.xmlæ–‡ä»¶å…¨è·¯å¾„
	
6. ```note-red 
	ç¼–å†™æµ‹è¯•ç±»
	```
`````



### é…ç½®æ–‡ä»¶ä»‹ç»
#### mapper.xml

![](https://gitee.com/javaTesteru/picgo/raw/master/images/testeru/javaweb-module/202205041122174.png)


````ad-info
1. XMLéƒ½æœ‰DTDçº¦æŸå¤´ï¼šæ ¸å¿ƒé…ç½®æ–‡ä»¶ã€æ˜ å°„é…ç½®æ–‡ä»¶

	[é…ç½®æ–‡ä»¶çº¦æŸå¤´](https://mybatis.org/mybatis-3/zh/getting-started.html)

````


## å¢åˆ æ”¹æŸ¥æ“ä½œ
### å¢åŠ 
#### æ˜ å°„é…ç½®æ–‡ä»¶

`````ad-note

å ä½ç¬¦ä¸º 
```note-pink
#{}
```
`````


- UserMapper.xml
```xml
<insert id="insertUser" parameterType="top.testeru.domain.TestUser">
    INSERT INTO
        test_user(user_name, password, email, auto_create_case_job_name, start_test_job_name,
                    default_jenkins_id, create_time, update_time)
    VALUES (#{userName}, #{password},  #{email},  #{autoCreateCaseJobName},  #{startTestJobName},
            #{defaultJenkinsId},#{createTime},  #{updateTime})
</insert>
```

#### æµ‹è¯•ç±»
```java
    public void insertUser() throws IOException {
        // 1.åŠ è½½æ ¸å¿ƒé…ç½®æ–‡ä»¶
        //æ ¸å¿ƒé…ç½®æ–‡ä»¶åŠ è½½æˆäº†ä¸€ä¸ªå­—èŠ‚è¾“å…¥æµ
        InputStream resourceAsStream = Resources.getResourceAsStream("sqlMapConfig.xml");
        // 2.è·å–sqlSessionFactoryå·¥å‚å¯¹è±¡
        SqlSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder();
        //build()æ˜¯ä¸€ä¸ªæ„å»ºå™¨çš„è®¾è®¡æ¨¡å¼
        SqlSessionFactory sqlSessionFactory = sqlSessionFactoryBuilder.build(resourceAsStream);
        // 3.è·å–sqlSessionä¼šè¯å¯¹è±¡
        SqlSession sqlSession = sqlSessionFactory.openSession();
        // 4.æ‰§è¡Œsql
        TestUser testUser = new TestUser();
        testUser.setUserName("ljl1");
        testUser.setPassword("good");
        testUser.setEmail("iisgood@qq.com");
        testUser.setCreateTime(LocalDate.now());
        testUser.setUpdateTime(LocalDate.now());

        int usersInsertNum = sqlSession.insert("user.insertUser",testUser);
        //sqlæ‰§è¡Œäº†ï¼Œäº‹åŠ¡æ²¡æœ‰commit
        sqlSession.commit();
        // 5.æ‰“å°ç»“æœ
        System.out.println(usersInsertNum);
        // 6.é‡Šæ”¾èµ„æº
        sqlSession.close();
    }
```
#### âš ï¸æ³¨æ„

`````ad-bug
æ‰§è¡Œæ’å…¥æ“ä½œï¼Œinsert è¿”å›1ï¼Œæ•°æ®åº“ä¸­æ— æ•°æ®
`````

- [>] **sqlæ‰§è¡Œäº†ï¼Œäº‹åŠ¡æ²¡æœ‰commit**

```note-red
sqlSession.commit();
	
```

#### æ€»ç»“
- [<] æ’å…¥è¯­å¥ä½¿ç”¨   <span class='pink'>insert</span> æ ‡ç­¾
- [<] åœ¨æ˜ å°„æ–‡ä»¶ä¸­ä½¿ç”¨  <span class='pink'>parameterType</span>  å±æ€§æŒ‡å®šè¦æ’å…¥çš„æ•°æ®ç±»å‹
- [<] Sqlè¯­å¥ä¸­ä½¿ç”¨  <span class='pink'>#{å®ä½“å±æ€§å}</span>  æ–¹å¼å¼•ç”¨å®ä½“ä¸­çš„å±æ€§å€¼
- [<] æ’å…¥æ“ä½œä½¿ç”¨çš„APIæ˜¯ 

```note-red 
sqlSession.insert(â€œå‘½åç©ºé—´.idâ€,å®ä½“å¯¹è±¡);
```
- [>] æ’å…¥æ“ä½œæ¶‰åŠæ•°æ®åº“æ•°æ®å˜åŒ–ï¼Œæ‰€ä»¥è¦ä½¿ç”¨sqlSessionå¯¹è±¡æ˜¾ç¤ºçš„æäº¤äº‹åŠ¡ï¼Œå³
```note-red
sqlSession.commit();
	
```


### ä¿®æ”¹
#### æ˜ å°„é…ç½®æ–‡ä»¶
- UserMapper.xml
```xml
<!--æ›´æ–°-->
<update id="updateUser" parameterType="top.testeru.domain.TestUser">
    UPDATE test_user SET user_name = #{userName}, password = #{password},email=#{email},update_time = #{updateTime} WHERE id = #{id};
</update>
```

#### æµ‹è¯•ç±»
```java
    public void updateUser() throws IOException {
        // 1.åŠ è½½æ ¸å¿ƒé…ç½®æ–‡ä»¶
        //æ ¸å¿ƒé…ç½®æ–‡ä»¶åŠ è½½æˆäº†ä¸€ä¸ªå­—èŠ‚è¾“å…¥æµ
        InputStream resourceAsStream = Resources.getResourceAsStream("sqlMapConfig.xml");
        // 2.è·å–sqlSessionFactoryå·¥å‚å¯¹è±¡
        SqlSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder();
        //build()æ˜¯ä¸€ä¸ªæ„å»ºå™¨çš„è®¾è®¡æ¨¡å¼
        SqlSessionFactory sqlSessionFactory = sqlSessionFactoryBuilder.build(resourceAsStream);
        // 3.è·å–sqlSessionä¼šè¯å¯¹è±¡
        SqlSession sqlSession = sqlSessionFactory.openSession();
        // 4.æ‰§è¡Œsql
        TestUser testUser = new TestUser();
        testUser.setId(388);
        testUser.setUserName("beijing");
        testUser.setPassword("2022");
        testUser.setEmail("iisbeijing@qq.com");
        testUser.setUpdateTime(LocalDate.now());

        int usersInsertNum = sqlSession.update("user.updateUser",testUser);
        //sqlæ‰§è¡Œäº†ï¼Œäº‹åŠ¡æ²¡æœ‰commit
        sqlSession.commit();
        // 5.æ‰“å°ç»“æœ
        System.out.println(usersInsertNum);
        // 6.é‡Šæ”¾èµ„æº
        sqlSession.close();
    }
```
#### âš ï¸æ³¨æ„
`````ad-bug
æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œéƒ¨åˆ†å­—æ®µå€¼æ•°æ®åº“æœªæ›´æ–°
`````
- [>] **sqlè¯­å¥ä¸­å°‘å†™å­—æ®µ**
#### æ€»ç»“
- [<] ä¿®æ”¹è¯­å¥ä½¿ç”¨<span class='pink'>update</span> æ ‡ç­¾
- [<] ä¿®æ”¹æ“ä½œä½¿ç”¨çš„APIæ˜¯
```note-red 
sqlSession.update(â€œå‘½åç©ºé—´.idâ€,å®ä½“å¯¹è±¡);
```

### åˆ é™¤
#### æ˜ å°„é…ç½®æ–‡ä»¶

- UserMapper.xml
```xml
<!--åˆ é™¤-->  
<delete id="deleteUser" parameterType="java.lang.Integer">  
	delete from test_user where id = #{id};    
</delete>
```
#### æµ‹è¯•ç±»
```java
    public void deleteUser() throws IOException {
        // 1.åŠ è½½æ ¸å¿ƒé…ç½®æ–‡ä»¶
        //æ ¸å¿ƒé…ç½®æ–‡ä»¶åŠ è½½æˆäº†ä¸€ä¸ªå­—èŠ‚è¾“å…¥æµ
        InputStream resourceAsStream = Resources.getResourceAsStream("sqlMapConfig.xml");
        // 2.è·å–sqlSessionFactoryå·¥å‚å¯¹è±¡
        SqlSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder();
        //build()æ˜¯ä¸€ä¸ªæ„å»ºå™¨çš„è®¾è®¡æ¨¡å¼
        SqlSessionFactory sqlSessionFactory = sqlSessionFactoryBuilder.build(resourceAsStream);
        // 3.è·å–sqlSessionä¼šè¯å¯¹è±¡
        SqlSession sqlSession = sqlSessionFactory.openSession();
        // 4.æ‰§è¡Œsql

        int usersInsertNum = sqlSession.delete("user.deleteUser", 388);
        //sqlæ‰§è¡Œäº†ï¼Œäº‹åŠ¡æ²¡æœ‰commit
        sqlSession.commit();
        // 5.æ‰“å°ç»“æœ
        System.out.println(usersInsertNum);
        // 6.é‡Šæ”¾èµ„æº
        sqlSession.close();
    }

```
#### âš ï¸æ³¨æ„

`````ad-bug
æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œä½¿ç”¨çš„æ˜¯å•ä¸ªå‚æ•°
`````

- [>] **sqlè¯­å¥ç¼–å†™ parameterType ä¸ºå‚æ•°ç±»å‹**

```note-red
parameterType="java.lang.Integer"
```



#### æ€»ç»“
- [<] åˆ é™¤ è¯­å¥ä½¿ç”¨   <span class='pink'>delete</span> æ ‡ç­¾
- [<] Sqlè¯­å¥ä¸­ä½¿ç”¨æ–¹å¼  <span class='pink'>#{ä»»æ„å­—ç¬¦ä¸²}</span>  å¼•ç”¨ä¼ é€’çš„å•ä¸ªå‚æ•°
- [<] åˆ é™¤æ“ä½œä½¿ç”¨çš„APIæ˜¯ 

```note-red 
sqlSession.delete(â€œå‘½åç©ºé—´.idâ€,Object);
```
- [>] åˆ é™¤æ“ä½œæ¶‰åŠæ•°æ®åº“æ•°æ®å˜åŒ–ï¼Œæ‰€ä»¥è¦ä½¿ç”¨sqlSessionå¯¹è±¡æ˜¾ç¤ºçš„æäº¤äº‹åŠ¡ï¼Œå³
```note-red
sqlSession.commit();
	
```




`````ad-important

````ad-need
title:æŸ¥è¯¢
color: 199, 21, 133

ä»£ç ï¼š
```note-purple-bg
List<User> list = 
			sqlSession.selectList("UserMapper.findAll");
```
æ˜ å°„æ–‡ä»¶ï¼š
```note-purple-bg
<select id="findAll" 
				resultType="top.testeru.domain.TestUser">  
     select * from test_user
</select>
```
````

````ad-need
title:æ–°å¢
color: 199, 21, 133


ä»£ç ï¼š
```note-purple-bg
int usersInsertNum = sqlSession.insert("user.insertUser",testUser);
```
æ˜ å°„æ–‡ä»¶ï¼š
```note-purple-bg
<insert id="insertUser" parameterType="top.testeru.domain.TestUser">
    INSERT INTO
        test_user(user_name, password, email, auto_create_case_job_name, start_test_job_name,
                  default_jenkins_id, create_time, update_time)
    VALUES (#{userName}, #{password},  #{email},  #{autoCreateCaseJobName},  #{startTestJobName},
            #{defaultJenkinsId},#{createTime},  #{updateTime})
</insert>

```
````




````ad-need
title:ä¿®æ”¹
color: 199, 21, 133

ä»£ç ï¼š
```note-purple-bg
int usersupdateNum = sqlSession.update("user.updateUser",testUser);
```
æ˜ å°„æ–‡ä»¶ï¼š
```note-purple-bg
<update id="updateUser" parameterType="top.testeru.domain.TestUser">
    UPDATE test_user SET user_name = #{userName}, password = #{password},email=#{email},update_time = #{updateTime} WHERE id = #{id};
</update>
```
````

````ad-need
title:åˆ é™¤
color: 199, 21, 133

ä»£ç ï¼š
```note-purple-bg
int usersdeleteNum = sqlSession.delete("user.deleteUser", 388);
```
æ˜ å°„æ–‡ä»¶ï¼š
```note-purple-bg
<delete id="deleteUser" parameterType="java.lang.Integer">
    delete from test_user where id = #{id};
</delete>
```
````
`````