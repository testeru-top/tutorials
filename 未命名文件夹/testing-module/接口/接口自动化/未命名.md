## 接口测试



我们为什么要做自动化测试？？

>花更多时间去学自动化 是为了对应自动化的框架设计，后面怎么花更少的时间去维护我们的框架，而不是写一个UI自动化脚本或者接口自动化脚本去维护，那每次新增一个接口还要重新写一个自动化脚本，工作量还是没变化

>大家如果能接触到公司的接口文档，可以自主的把接口自动化这个事情开展出来。
>如果没有接口文档，大家在测试的过程中可以用青花瓷来多次抓包，这样也能把接口的请求都能拿到，可以用自己写的接口框架，或者postman还有Jmeter 去测试一下这些抓到的接口，看看是不是能发现一些问题，这样我们后面也可以写在我们自己的简历里面








when:

what：所有的接口最好都进行接口测试。  并且尽量覆盖全面的用例。
==异常用例和场景设计==才是重点。

>减去性能相关、安全相关的测试用例，没准也有几千条，自动化UI的用例实现其中的几百条，已经就很高了。但是接口自动化不一样，有可能会实现


>无论是web还是app都是跟服务器进行交互做接口测试


how：
	1、先获取接口信息 （最好让开发提供详尽的接口文档，springboot项目一般都会用swagger来进行接口文档的生成和管理 ）
		如果是自己去测着玩，没有规范文档，就通过抓包来获取接口信息。

				接口信息要获取什么？
					接口的功能描述。

					需要模拟客户端发给服务器的请求调用接口需要的就是请求和返回的尽可能详细的信息：
						请求：
							请求行：url  http方法  
							请求头：通常情况下不用特殊关注，但是接口文档里面写了的，就一定要测。
								对于post、put接口来说  content-type是必须要描述清楚的。
							请求体：请求参数，一般是测试重点， 注意确认是否是必填项。
					
						返回：
							返回行：状态码 状态描述。  注意进行测试的时候，都是希望得到200。
								至少保证接口成功得到返回，才谈得上验证业务正确性。
							头：一般都不会看。除非有特别说明。
							体：验证的就是返回体。  返回体中会有各种键值对， 需要开发做字段的说明。
						
			2、设计测试用例。
				最重要的设计方式，由于参数都已经被抽象成为了键值对，等价类边界值方法成为了最常用的设计方法。
				注意参数 不填 和 填空值是完全两回事
					user=&pwd=1234    服务器读到的是个""
					pwd=1234    	服务器读到的是个null

				参数组合的设计：  直接穷举排列组合会得到非常多的用例，可以基于业务场景（黑盒）和路径覆盖（白盒）来进行用例的精简。 通常情况下，非必填参数，可以作为一个整体来进行是否填写的设计。  多使用正交表来进行设计。
				

			3、向服务器发起请求
				工具可以有很多：postman jmeter soapui 
				使用httpclient库、也可以用okhttp、rest-assured。
					引入httpclient依赖：
<dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.5.13</version>
        </dependency>
        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpmime</artifactId>
            <version>4.5.11</version>
        </dependency>
				有可能使用的时候会缺少common.io的库，出现classNotFound的异常，到maven中搜一下，也可以直接把appium的库加上。
				
				使用httpclient进行请求的时候，是自带log4j日志记录的，如果想要看httpclient实际发送的报文，就可以将log4j2.xml文件中的<root level="debug"> 改成debug就行，如果不想看就改成比debug高的，比如info。
				这是最重要的调试信息！！！！


			4、验证服务器返回的结果。
				对于返回结果的校验，其实就是对于字符串的校验。  当然文件类型的另说。
					

				
3、作业：
	实现ip接口get请求，和电商登录post请求。 也可以多测点其它接口
		腾讯课堂课程的评论接口，get请求，进行测试。
		https://ke.qq.com/cgi-bin/comment_new/course_comment_list?cid=396274&count=10&page=0&filter_rating=0&bkn=747793626&r=0.19119588423470235

		同时尝试修改各种参数，设计测试用例。
		


	
就还是拿这个审批来说，我们有一个小商户的优惠费率审批，最后优惠费率审批资格交给了运营，当时产品提出第一个需求就是，在页面搜索对应可以优惠的商户id，固定优惠费率是0.38，然后审批，由于这个产品是新来的，她觉得这个审批开通和这个费率优惠可以是一个，后面真的启动了优惠服务，发现每天的商户太多了，然后又开始加导入Excel解析到页面，然后又发现第三方给了新的活动，不只可以申请0.38的活动费率，还可以申请0.2的费率，然后又新增可选优惠费率0.2，然后又发现渠道可以选择多个，又去添加