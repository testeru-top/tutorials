
# å¼€åœºç™½

åŒå­¦ä»¬ä¸‹åˆå¥½ï¼æˆ‘æ˜¯ä»Šå¤©çš„ä¸»è®²è€å¸ˆï¼šç›–ç›–ã€‚æ¬¢è¿å¤§å®¶å‚åŠ ä»Šå¤©çš„webè‡ªåŠ¨åŒ–æµ‹è¯•å®æˆ˜ï¼<br />éå¸¸é«˜å…´åˆå’Œå¤§å®¶åˆè§é¢äº†ï¼

- [x] webè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸“é¢˜çš„å½•æ’­è¯¾å†…å®¹è¿˜æ˜¯æŒºå¤šçš„ï¼Œå½•æ’­è§†é¢‘åŸºæœ¬çœ‹å®Œçš„åŒå­¦ï¼Œç»™æˆ‘ä¸€ç‚¹åé¦ˆï¼Œå¸®å¿™åœ¨è®¨è®ºåŒºä¸Šæ‰£ä¸ª1

å½“ç„¶äº†ï¼Œæ²¡çœ‹å®Œçš„åŒå­¦ä¹Ÿä¸è¦ç´§ï¼Œå…ˆè·Ÿä¸Šä»Šå¤©çš„å®æˆ˜è¯¾ç¨‹ã€‚å¦‚æœé‡åˆ°ä¸ç†Ÿæ‚‰çš„çŸ¥è¯†ç‚¹ï¼Œè¯¾åè®°å¾—æ‰¾æ—¶é—´å†è¡¥å›æ¥ã€‚


OKï¼Œæˆ‘ä»¬æ­£å¼è¿›å…¥ä»Šå¤©çš„è¯¾ç¨‹ã€‚

---

# è¯¾ç¨‹ç›®å½•

é¦–å…ˆï¼Œä»‹ç»ä¸‹æœ¬æœŸè¯¾ç¨‹çš„å®‰æ’ã€‚

ä¸€å…±åˆ†ä¸ºä¸¤èŠ‚è¯¾ï¼Œä»Šå¤©æ˜¯ç¬¬ä¸€èŠ‚ï¼Œæ³¨é‡åŸºç¡€ï¼›ä¸‹èŠ‚è¯¾åœ¨7æœˆ10å·ï¼Œæ³¨é‡POè®¾è®¡æ¨¡å¼ã€‚

è¿™2æ¬¡ç›´æ’­è¯¾å†…å®¹æ˜¯å›´ç»•ä¼ä¸šå¾®ä¿¡äº§å“ï¼Œå¸¦é¢†å¤§å®¶å¤ä¹ ç›®å‰å­¦è¿‡çš„webè‡ªåŠ¨åŒ–çŸ¥è¯†ã€‚<br />ç„¶åè¿›è¡Œç”¨ä¾‹åˆ†æï¼Œå¹¶ä¸”æ ¹æ®ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯ï¼Œç•™å‡ºä¸€éƒ¨åˆ†æ—¶é—´ç»™å¤§å®¶è¿›è¡Œè¯¾å ‚ç»ƒä¹ ï¼Œç¼–å†™å®æˆ˜è„šæœ¬ã€‚<br />æœ€åï¼Œæˆ‘å†æ¥è®²è§£ä¸‹å…·ä½“çš„webè‡ªåŠ¨åŒ–ä»£ç å®ç°ã€‚

ä¸‹èŠ‚è¯¾ï¼Œä¼šç•¥å¾®å¢åŠ ä¸€ç‚¹éš¾åº¦ï¼Œå°†åœ¨ä»Šå¤©è¯¾ç¨‹ä»£ç çš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œä¸€ç³»åˆ—çš„ä¼˜åŒ–ï¼Œé‡ç‚¹æ˜¯POè®¾è®¡æ¨¡å¼ã€‚



# äº§å“ä»‹ç»
é‚£ä¹ˆåˆšåˆšå¯èƒ½å·²ç»å‰§é€äº†å¯¹å§ï¼Œä»Šå¤©æˆ‘ä»¬é€‰ç”¨çš„çŸ¥åäº§å“å°±æ˜¯ä¼ä¸šå¾®ä¿¡äº†ã€‚<br />å®ƒæ˜¯ä¸€æ¬¾éå¸¸å¼ºå¤§çš„ä¼ä¸šé€šè®¯ä¸åŠå…¬å·¥å…·ï¼Œæ‹¥æœ‰éå¸¸ä¸°å¯Œçš„OAåº”ç”¨ã€‚

é‚£ä¸ºä»€ä¹ˆé€‰æ‹©ä¼ä¸šå¾®ä¿¡å‘¢ï¼Ÿä¸»è¦æœ‰ä¸¤ç‚¹åŸå› ã€‚

ç¬¬ä¸€ç‚¹æ˜¯ï¼Œä¼ä¸šå¾®ä¿¡äº§å“éå¸¸æˆç†Ÿï¼Œå¹¶ä¸”UIç•Œé¢ç›¸å¯¹ç¨³å®šï¼Œå¤æ‚åº¦é€‚ä¸­ï¼Œéå¸¸é€‚åˆwebè‡ªåŠ¨åŒ–ç»ƒä¹ ã€‚
ä¼ä¸šå¾®ä¿¡æ˜¯ä¸€æ¬¾ç¬¦åˆå¤§å‚æµç¨‹è§„èŒƒçš„`app`ï¼Œå¯¹åº”çš„ä¸šåŠ¡æµç¨‹å®¡æ‰¹åŠæ‰“å¡éƒ½å¾ˆè§„èŒƒï¼Œè€Œä¸”ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥åˆ›å»ºå±äºè‡ªå·±çš„ä¼ä¸šï¼Œä¸éœ€è¦è®¤è¯ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é€‰ç”¨è¿™ä¸€æ¬¾æ¥è¿›è¡ŒUIè‡ªåŠ¨åŒ–æ¼”ç¤ºã€‚


ç¬¬äºŒç‚¹æ˜¯ï¼Œä¼ä¸šå¾®ä¿¡çš„ç»ˆç«¯æ”¯æŒéå¸¸å…¨é¢ï¼Œä¸ä»…æœ‰webç«¯ï¼Œè€Œä¸”è¿˜æœ‰appï¼Œå¹¶ä¸”å®ƒçš„æ¥å£æ–‡æ¡£ä¹Ÿæ˜¯éå¸¸å®Œå¤‡ã€‚å› æ­¤éå¸¸é€‚åˆç”¨æ¥ä½œä¸ºå…¨æµç¨‹çš„å®æˆ˜è®­ç»ƒã€‚<br />åŸºæœ¬ä¸Šé¢é¢ä¿±åˆ°ï¼Œè¿™æ ·å¤§å®¶å°±å¯ä»¥å›´ç»•ä¸€æ¬¾äº§å“ï¼Œæ¥æ¨¡æ‹ŸçœŸå®çš„å·¥ä½œä¸­é‡åˆ°çš„å„ç±»è‡ªåŠ¨åŒ–æµ‹è¯•åœºæ™¯ï¼Œåšåˆ°ä¸€ç«™å¼çš„ç»ƒä¹ ã€‚

åŒæ—¶ï¼Œè¿™é‡Œéœ€è¦å¤§å®¶æå‰å‡†å¤‡ä¸€ä¸‹ä¼ä¸šå¾®ä¿¡çš„æµ‹è¯•è´¦å·ï¼Œæ˜¯å¯ä»¥å…è´¹æ³¨å†Œçš„ã€‚è¿‡ç¨‹éå¸¸ç®€å•ï¼Œå…·ä½“æ­¥éª¤åœ¨è¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚<br />å¦‚æœæ²¡æœ‰ç”¨è¿‡è¿™æ¬¾äº§å“çš„åŒå­¦å‘¢ï¼Œå¯ä»¥å…ˆå¬è¯¾ï¼Œç¨åå†è¯¾å ‚ç»ƒä¹ çš„æ—¶é—´æ³¨å†Œæµ‹è¯•è´¦å·å³å¯ã€‚

---

é‚£ä¹ˆï¼Œäº§å“å’Œä¸šåŠ¡åœºæ™¯æˆ‘ä»¬éƒ½è§è¯†è¿‡æ¥ï¼Œæ°”æ°›å·²ç»çƒ˜æ‰˜åˆ°è¿™é‡Œäº†ï¼Œæ¬¸ï¼Œæˆ‘ä»¬åˆåˆ°äº†å–œé—»ä¹è§çš„ç¯èŠ‚äº†ï¼Œè®²ä¸ªæ•…äº‹å¯¹å§ã€‚æˆ‘ä»¬æ¥èŠèŠä¸€ä¸ªå…³äºç‚¹å·¥æˆé•¿å†ç¨‹çš„æ•…äº‹ã€‚
# ç¬¬ä¸€å›ï¼šç‚¹ç‚¹ç‚¹


è¯è¯´ï¼Œæˆ‘ä»¬ä»Šå¤©çš„ä¸»äººå…¬ï¼Œå½“ç„¶æ˜¯è™šæ‹Ÿçš„äº†ï¼Œæ˜¯ä¸€ä½ååˆ†è¾›è‹¦çš„ç‚¹å·¥ï¼Œåˆšå¥½è´Ÿè´£çš„é¡¹ç›®æ­£æ˜¯ä¼ä¸šå¾®ä¿¡webç«¯çš„æµ‹è¯•ï¼Œæ¯å¤©çš„å·¥ä½œå‘¢è‡ªç„¶æ˜¯ç‚¹ç‚¹ç‚¹äº†ã€‚å› æ­¤æ±Ÿæ¹–äººç§°ç‚¹ç‚¹ã€‚

OKï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç‚¹ç‚¹æœ€è¿‘åœ¨å¿™å•¥ï¼Œä»–æœ€è¿‘çš„ä»»åŠ¡åˆšå¥½å°±æ˜¯ï¼Œæµ‹è¯•ä¼ä¸šå¾®ä¿¡é€šè®¯å½•çš„æ·»åŠ æˆå‘˜åŠŸèƒ½ã€‚å…·ä½“æ€ä¹ˆä¸ªåŠŸèƒ½å‘¢ï¼Ÿå°±æ˜¯è¿™æ ·ç‚¹çš„ï¼Œå…ˆæ¥æ‰“ä¸ªæ ·ã€‚

ã€æ¼”ç¤ºã€‘æ‰‹å·¥åœºæ™¯ï¼šæ¼”ç¤ºæ‰‹å·¥æ‰§è¡Œæ·»åŠ ä¼ä¸šå¾®ä¿¡é€šè®¯å½•çš„åœºæ™¯
```
åŠŸèƒ½æµ‹è¯•åœºæ™¯ï¼šä¼ä¸šå¾®ä¿¡æ·»åŠ æˆå‘˜ï¼ˆwebç«¯ï¼‰

1. ç™»å½•
2. ç‚¹å‡»æ·»åŠ æˆå‘˜æŒ‰é’®
3. å¡«å†™æˆå‘˜ä¿¡æ¯
4. æŸ¥çœ‹ç»“æœ

```

å¥½ï¼Œé‚£æˆ‘ä»¬æ¥åˆ†æçœ‹çœ‹ï¼Œä»–çš„æ‰‹å·¥æµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯åŠŸèƒ½æµ‹è¯•çš„è¿‡ç¨‹ã€‚
# ç”¨ä¾‹è®¾è®¡ï¼šæ‰‹å·¥æµ‹è¯•
è¿™å¼ æ—¶åºå›¾ä¸­ï¼Œä¸€å…±æœ‰ä¸¤ä¸ªå‚ä¸è§’è‰²ï¼Œä¸€ä¸ªæ˜¯æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œä¸€ä¸ªæ˜¯æˆ‘ä»¬çš„è¢«æµ‹webé¡µé¢ã€‚

é‚£åœ¨åŠŸèƒ½æµ‹è¯•çš„è¿‡ç¨‹å½“ä¸­ï¼Œç¬¬ä¸€æ­¥ï¼Œæ˜¯ç”±æˆ‘ä»¬çš„æµ‹è¯•å·¥ç¨‹å¸ˆå¯¹æˆ‘ä»¬çš„è¢«æµ‹ç³»ç»Ÿçš„é¡µé¢åšä¸€äº›ç‚¹å‡»æˆ–è€…è¾“å…¥ç­‰ç­‰ç±»å‹çš„ä¸€ä¸ªæ“ä½œã€‚<br />é‚£è¿™æ—¶å€™ç³»ç»Ÿçš„äº¤äº’æ“ä½œï¼Œä¼šäº§ç”Ÿä¸€å®šçš„é¡µé¢çš„å“åº”ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç¬¬äºŒæ­¥ï¼Œé¡µé¢å“åº”ã€‚<br />ç„¶åï¼Œç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬çš„æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œè¦æ‹¿åˆ°è¿™ä¸ªç³»ç»Ÿè¿è¡Œçš„è¿™ä¸ªå“åº”ï¼Œé‚£ä¹Ÿå°±æ˜¯å®ƒçš„ä¸€ä¸ªå®é™…ç»“æœï¼Œå’Œæˆ‘ä»¬æµ‹è¯•ç”¨ä¾‹å½“ä¸­ç¼–å†™çš„ä¸€ä¸ªé¢„æœŸç»“æœå»åšä¸€ä¸ªå¯¹æ¯”ã€‚é‚£è¿™ä¸ªæ˜¯æˆ‘ä»¬åŠŸèƒ½æµ‹è¯•çš„ä¸€ä¸ªåœºæ™¯ï¼Œéå¸¸çš„ç®€å•ã€‚


- ç—›ç‚¹

å°±è¿™æ ·æ—¥å¤ä¸€æ—¥ï¼Œæˆ‘ä»¬çš„ç‚¹ç‚¹åŒå­¦å‘ç°å¿ƒå¥½ç´¯ï¼Œæ¯æ¬¡ä¸ç®¡æ˜¯è¿­ä»£éœ€æ±‚ï¼Œè¿˜æ˜¯å›å½’æµ‹è¯•ï¼Œéƒ½è¦æ¥å›ç‚¹ç‚¹ç‚¹ï¼Œæ²¡å®Œæ²¡äº†ï¼Œæ—¥å­å•¥æ—¶å€™æ˜¯ä¸ªå¤´ã€‚

é‚£ä¹ˆé—®é¢˜ç‚¹æ¥äº†ï¼Œåˆè‹¦åˆç´¯ï¼Œæ²¡æœ‰æŠ€æœ¯å«é‡ï¼Œæ„å‘³ç€æ²¡æœ‰ç«äº‰åŠ›ï¼Œå®¹æ˜“æ€ä¹ˆæ ·ï¼Ÿå–œææ¯•ä¸šå¯¹å§ã€‚

ã€äº’åŠ¨ã€‘ä»ç‚¹ç‚¹åŒå­¦çš„è¿™ä¸ªå¤„å¢ƒä¸­ï¼Œæˆ–å¤šæˆ–å°‘ï¼Œæœ‰æ²¡æœ‰çœ‹åˆ°è‡ªå·±å½“å¹´ï¼Œæˆ–è€…æ˜¯ç°åœ¨çš„å½±å­ï¼Ÿ<br />å¦‚æœæœ‰æ„ŸåŒèº«å—çš„åŒå­¦ï¼Œå¯ä»¥æ‰£æ³¢1ã€‚

- å¯¹ç­–

é‚£ç©¶ç«Ÿæ€ä¹ˆçªç ´è¿™ä¸ªç“¶é¢ˆå‘¢ï¼Œç­”æ¡ˆå°±æ˜¯ï¼Œä½¿ç”¨UIè‡ªåŠ¨åŒ–æµ‹è¯•æŠ€æœ¯å¯¹å§ã€‚

# ç¬¬äºŒå›ï¼šUIè‡ªåŠ¨åŒ–æµ‹è¯•

é‚£ï¼Œè¯´åˆ°UIè‡ªåŠ¨åŒ–ï¼Œéš¾å…ç»å¸¸ä¼šå¬åˆ°åæ§½è¯´ï¼ŒUIè‡ªåŠ¨åŒ–å­˜åœ¨æ‰§è¡Œæ•ˆç‡è¶Šä½ï¼Œæˆæœ¬åˆé«˜å•Šä¹‹ç±»çš„ã€‚

å°±åƒè¿™å¼ å›¾ä¸­æ‰€ç¤ºï¼ŒUI å’Œæ¥å£æµ‹è¯•ï¼Œè¿˜æœ‰å•å…ƒæµ‹è¯•ä¸€ä¸ªå¯¹æ¯”ã€‚<br />ä¹Œé¾Ÿå’Œå…”å­ï¼Œè¡¨ç¤ºçš„æ˜¯æ•ˆç‡ç”±ä½åˆ°é«˜ï¼›è¿™é‡Œçš„ç¾å…ƒç¬¦å·å’Œæ¬§å…ƒç¬¦å·ï¼Œåˆ™è¡¨ç¤ºçš„æ˜¯æˆæœ¬ç”±é«˜åˆ°ä½ã€‚<br />é‚£å…¶å®å¯¹æ¯”æ¥è¯´ï¼ŒUIç›¸å¯¹æ˜¯æ•ˆç‡è¾ƒä½ï¼Œæˆæœ¬è¾ƒé«˜çš„ä¸€ä¸ªé˜¶æ®µã€‚

é‚£ä¹ˆæœ‰çš„åŒå­¦ä¸ç¦è¦é—®ï¼Œé‚£ä¸ºä»€ä¹ˆUIè¿˜ä¼šå æ®è¿™æ ·ä¸€ä¸ªæ¯”é‡ï¼Œè€Œæ²¡æœ‰å¹²è„†æ¶ˆå¤±å‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜éœ€è¦å­¦ä¹ UIè‡ªåŠ¨åŒ–æŠ€æœ¯å‘¢ï¼Ÿ

é‚£æ˜¯å› ä¸ºï¼Œç¬¬ä¸€ç‚¹ï¼Œç›¸å¯¹äºæ‰‹å·¥ï¼Œæˆ–è€…äººåŠ›æµ‹è¯•æ¥è¯´ï¼ŒUIè‡ªåŠ¨åŒ–çš„æ‰§è¡Œæ•ˆç‡åˆ™æ›´é«˜ã€‚å°¤å…¶æ˜¯ï¼Œé€šè¿‡æŒç»­é›†æˆçš„åŠ æˆï¼ŒåŒæ ·å¯ä»¥åšåˆ°æˆæœ¬æ›´ä½ã€‚æ‰€ä»¥ï¼Œè¿™æ˜¯å®ƒçš„ä¸€ä¸ªç”¨æ­¦ä¹‹å¤„ï¼Œçœ‹é—®é¢˜çš„è§’åº¦éå¸¸å…³é”®ã€‚ç‰¹åˆ«æ˜¯é‡åˆ°éœ€è¦é¢‘ç¹å›å½’çš„åœºæ™¯ï¼Œè¿˜æœ‰éå¸¸é‡ç‚¹çš„æ ¸å¿ƒä¸šåŠ¡åœºæ™¯ï¼Œå°±éå¸¸é€‚åˆåšUIè‡ªåŠ¨åŒ–ã€‚å½“ç„¶æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯UIæˆ–è€…ä¸šåŠ¡æµç¨‹å˜åŠ¨ä¸èƒ½å¤ªå¤§ã€‚

ç¬¬äºŒç‚¹ï¼Œæœ‰äº›åœºæ™¯ï¼Œæ¯”å¦‚è¯´æ¶‰åŠåˆ°ï¼Œå¦‚æœéœ€è¦æµ‹è¯•æµè§ˆå™¨çš„å…¼å®¹æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªé¢†åŸŸï¼Œå…¶å®å•å…ƒæµ‹è¯•å’Œæ¥å£æµ‹è¯•æ˜¯ä¸èƒ½å¤Ÿå®Œæˆä»»åŠ¡çš„ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡seleniumåˆ†å¸ƒå¼æ‰§è¡Œç­‰æ–¹å¼ï¼Œæ¥å¾ˆå¥½åœ°å®ç°å’Œæ»¡è¶³è¿™æ ·çš„éœ€æ±‚ã€‚

é‚£ä¹ˆç¬¬ä¸‰ç‚¹ï¼Œå°±æ˜¯å¸‚åœºéœ€æ±‚ã€‚é‚£ä¹ˆæµ‹è¯•è¡Œä¸šè¶Šæ¥è¶Šå·å¯¹å§ï¼Œå¦‚æœæ²¡æœ‰æŒæ¡è‡ªåŠ¨åŒ–çš„ç›¸å…³çŸ¥è¯†ï¼Œé‚£ä¹ˆé¢è¯•å®˜å†…å®¹æ¯«æ— æ³¢æ¾œã€‚è€Œä¸”ï¼ŒUIè‡ªåŠ¨åŒ–ä¸­çš„webdriverï¼ŒPOæ€æƒ³ï¼Œéƒ½æ˜¯éå¸¸æœ‰ä»·å€¼çš„ï¼Œç»å¯¹æ˜¯å‡èŒåŠ è–ªï¼Œæå‡èŒåœºç«äº‰åŠ›çš„ç§˜è¯€ã€‚<br />å°±åƒåˆšåˆšè¯´çš„ï¼Œç‚¹ç‚¹åŒå­¦é‡åˆ°çš„ç—›ç‚¹ä¸€æ ·å¯¹å§ã€‚

æ‰€ä»¥ï¼Œä»¥ä¸Šè¿™äº›ï¼Œå°±æ˜¯UIè‡ªåŠ¨åŒ–çš„ä»·å€¼æ‰€åœ¨ã€‚

Okï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œç‚¹ç‚¹åŒå­¦è¦å­¦çš„æŠ€æœ¯æ ˆï¼Œseleniumè‡ªåŠ¨åŒ–æ¡†æ¶ã€‚
# seleniumæ¶æ„ï¼ˆè„‘å›¾å±•ç¤ºï¼‰



- ç‰¹ç‚¹

å…ˆæ¥è¯´è¯´ï¼ŒSeleniuméƒ½æœ‰ä»€ä¹ˆç‰¹ç‚¹å‘¢ï¼š

- **å¼€æºï¼Œå…è´¹**
- **å¤šæµè§ˆå™¨æ”¯æŒï¼šFirefoxã€Chromeã€IE**
- **å¤šå¹³å°æ”¯æŒï¼šLinuxã€Windowsã€Mac**
- **å¤šè¯­è¨€æ”¯æŒï¼šJavaã€Pythonã€Rubyã€Phpã€C#**
- **å¯¹Webé¡µé¢æ”¯æŒå‹å¥½**
- **APIç®€å•ï¼Œè°ƒç”¨çµæ´»ï¼Œå¼€å‘è¯­è¨€é©±åŠ¨**
- **æ”¯æŒåˆ†å¸ƒå¼æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œ**

é‚£ä¹ˆè¿™äº›å°±æ˜¯é€‰ç”¨seleniumçš„ç†ç”±ã€‚

å½“ç„¶å¯èƒ½è¿˜æœ‰å…¶ä»–çš„webè‡ªåŠ¨åŒ–æŠ€æœ¯ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å…´è¶£äº†è§£ä¸‹ï¼Œæ¯”å¦‚Cypressï¼ŒAirtestç­‰ç­‰ï¼Œéƒ½æœ‰ä¸€äº›è‡ªå·±çš„ç‰¹ç‚¹ã€‚

- æ¶æ„å›¾

>æˆ‘è¦å¼€é—¨
>æˆ‘å°±æ˜¯å†™çš„è„šæœ¬
>å¼€é—¨éœ€è¦é’¥åŒ™æˆ–è€…å¯†ç  driverå°±ç›¸å½“äºè¿™ä¸ªé’¥åŒ™
>é—¨è¿™ä¸ªå¯¹è±¡å°±ç›¸å½“äºè¢«æµ‹çš„äº§å“

OKï¼Œæˆ‘ä»¬å›åˆ°è¿™å¼ å›¾ï¼Œè¿™æ˜¯seleniumçš„åŸºæœ¬çš„æ¶æ„ç¤ºæ„å›¾ã€‚<br />è¿™é‡Œæœ‰3ä¸ªè§’è‰²ï¼Œæˆ‘ä»¬ä»å³å¾€å·¦çœ‹ï¼Œä¾æ¬¡æ˜¯browserè¡¨ç¤ºæµè§ˆå™¨ã€driverè¡¨ç¤ºwebdriverï¼Œclientè¡¨ç¤ºæµ‹è¯•è„šæœ¬ã€‚

æˆ‘ä»¬éƒ½ç›´åˆ°ï¼Œå¸‚é¢ä¸Šçš„æµè§ˆå™¨éå¸¸å¤šï¼Œä½†æ˜¯ä¸»æµçš„å°±å‡ ç§ï¼Œæ¯”å¦‚chromeï¼ŒFirefoxç«ç‹ï¼Œè¿˜æœ‰å¾®è½¯çš„IEã€‚é‚£ä¹ˆæµè§ˆå™¨æ˜¯webåº”ç”¨çš„è½½ä½“ã€‚

é‚£ä¹ˆdriverå‘¢ï¼Œå°±æ˜¯è¡¨ç¤ºæˆ‘ä»¬seleniumæä¾›çš„webdriverï¼Œå®ƒé€šè¿‡æµè§ˆå™¨çš„åŸç”Ÿç»„ä»¶ï¼Œè½¬æ¢web serviceçš„å‘½ä»¤ç»™æµè§ˆå™¨nativeçš„è°ƒç”¨ï¼Œä»è€Œå®Œæˆå‘è¿‡æ¥çš„æŒ‡ä»¤æ“ä½œã€‚

é‚£ä¹ˆè¿™ä¸ªweb serviceæ˜¯å“ªé‡Œæ¥çš„å‘¢ï¼Ÿé‚£å°±æ˜¯ä»æˆ‘ä»¬å®¢æˆ·ç«¯clientè¿™éƒ¨åˆ†æ¥çš„ï¼Œä¹Ÿå°±æ˜¯æºè‡ªæˆ‘ä»¬çš„æµ‹è¯•è„šæœ¬ã€‚å‰é¢æˆ‘ä»¬æåˆ°è¿‡ï¼Œseleniumçš„å¤šè¯­è¨€æ”¯æŒï¼ŒåŒ…æ‹¬Javaã€Pythonã€Rubyç­‰ç­‰ä¸€ç³»åˆ—çš„è¯­è¨€ã€‚

- è¿è¡Œæœºåˆ¶

å½“æˆ‘ä»¬çš„æµ‹è¯•è„šæœ¬è¿è¡Œåï¼Œä¼šæ‰“å¼€æŒ‡å®šçš„æµè§ˆå™¨ï¼›<br />
æ¯”å¦‚æ‰“å¼€çš„æ˜¯chrome æµè§ˆå™¨ï¼Œä¼šä½¿ç”¨chromedriverè¿™æ ·çš„é©±åŠ¨ï¼Œ
è¿™æ—¶å€™ï¼Œwebdriverä¼šå°†ç›®æ ‡æµè§ˆå™¨ç»‘å®šåˆ°ç‰¹å®šçš„ç«¯å£ï¼Œå¯åŠ¨åçš„æµè§ˆå™¨ï¼Œä½œä¸ºwebdriverçš„è¿œç¨‹æœåŠ¡å™¨ï¼ˆç›¸å½“äºç»å¸¸è¯´çš„ä¸€ä¸ªæ¦‚å¿µremote serveræœåŠ¡ç«¯ï¼‰ï¼ŒæŒç»­çš„æ¥æ”¶æµ‹è¯•è„šæœ¬çš„æŒ‡ä»¤<br />ç„¶åï¼Œè„šæœ¬çš„æŒ‡ä»¤é€šè¿‡CommadExecutoræ‰§è¡Œå™¨ å‘é€HTTPè¯·æ±‚ç»™è¿™ä¸ªè¿œç¨‹æœåŠ¡å™¨remote serverã€‚

é‚£ä¹ˆè¿™æ˜¯seleniumçš„ä¸€ä¸ªè¿è¡Œæœºåˆ¶ã€‚
æ¯”å¦‚ï¼Œè¦å®Œæˆä¸€ä¸ªå¯»æ‰¾å…ƒç´ æ“ä½œï¼Œä¼šå‘é€è¯·æ±‚ç»™chromedriver ï¼Œä¼šå‘ç»™æˆ‘ä»¬å¯åŠ¨çš„æµè§ˆå™¨ï¼Œç„¶åæ ¹æ®å®ƒçš„å®šä½æ–¹å¼ ï¼Œå»é¡µé¢ä¸Šæ‰¾å®ƒï¼Œå»è§£æåŸç ï¼Œç„¶åæŠŠæ‰¾åˆ°çš„å…ƒç´ è¿”å›ï¼Œ

ç„¶åè¿›è¡Œåç»­æ“ä½œï¼Œå¾ªç¯å¾€å¤

å¦‚æœæ²¡æœ‰æ‰¾åˆ°å‘¢ï¼Ÿæ²¡æœ‰ç™»å½•è¿›å»ï¼Œæ²¡æœ‰æ‰¾åˆ°æ·»åŠ æˆå‘˜çš„æŒ‰é’®ï¼Œå°±ä¼šè¿”å›404ï¼Œï¼ˆ404æ¥å£æµ‹è¯•ä¸­ï¼ŒæœåŠ¡ä¸€ä¸ªé€šç”¨çš„å“åº”çŠ¶æ€ç ï¼‰


- [x] é‚£å¯¹äºseleniumçš„æ¶æ„å’Œè¿è¡Œæœºåˆ¶ï¼Œèƒ½å¤Ÿç†è§£çš„åŒå­¦ï¼Œå¸®å¿™æ‰£ä¸€ä¸ª1.

å­˜åœ¨æœ‰ç–‘é—®çš„åŒå­¦ï¼Œè¯·éšæ—¶æŠŠé—®é¢˜éšæ—¶å†™å‡ºæ¥ã€‚

å½“ç„¶ï¼Œè¿™é‡Œçš„çŸ¥è¯†æ˜¯éå¸¸æ·±å¥¥çš„ï¼Œå¤§å®¶å…ˆåšä¸€ä¸ªæ¦‚å¿µæ€§çš„ç†è§£ã€‚å¦‚æœé¢è¯•æ—¶å€™è¢«é—®åˆ°seleniumçš„æœºåˆ¶ï¼Œå°±å¯ä»¥æŒ‰ç…§è¿™æ ·çš„æ€è·¯å›ç­”å³å¯ã€‚


OKï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å›´ç»•å½•æ’­è§†é¢‘æ‰€æ¶µç›–çš„seleniumè‡ªåŠ¨åŒ–çš„çŸ¥è¯†ï¼Œæ¥å¸®åŠ©å¤§å®¶åšä¸€ä¸ªçŸ¥è¯†å›é¡¾ã€‚

è¿™é‡Œæ‰“å¼€ä¸€ä¸ªè„‘å›¾å·¥å…·ï¼Œæ¥æ‹ä¸€æ‹ã€‚å¤§å®¶ä¸€å®šè¦è·Ÿç€è€å¸ˆä¸€èµ·ï¼ŒåŠªåŠ›å›æƒ³ä¸€ä¸‹ã€‚<br />çŸ¥è¯†ï¼Œé‡åœ¨æ€»ç»“å½’çº³ï¼Œæ‰èƒ½æ˜“äºå¸æ”¶ï¼Œæœ€åå˜æˆè‡ªå·±æˆé•¿çš„è¥å…»ã€‚
# çŸ¥è¯†å›é¡¾
å¼€å¯æ€ç»´å¯¼å›¾ã€‚


**IDE**å°±æ˜¯å¸¸ç”¨çš„å¯è§†åŒ–é›†æˆå¼€å‘å·¥å…·ï¼Œç”¨äºå½•åˆ¶ï¼Œå›æ”¾è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚

**Grid**å°±æ˜¯åˆ†å¸ƒå¼ï¼Œæ˜¯Seleniumæ”¯æŒåˆ†å¸ƒå¼çš„å…³é”®æ¨¡å—ã€‚èƒ½å¤Ÿå¯¹ä¸åŒçš„è½¯ä»¶ï¼Œé‡‡å–åˆ†å¸ƒå¼æ–¹å¼è¿è¡Œï¼Œåœ¨åŒä¸€æ—¶é—´æ®µè¿è¡Œä¸åŒçš„è„šæœ¬ï¼Œå¯¹BSç»“æ„æœåŠ¡å™¨è¿›è¡Œæµ‹è¯•ï¼Œä»¥åŠæ”¯æŒå¤šå°æœºå™¨ä¸Šå¹¶è¡Œè¿è¡Œã€‚

**webdriveråˆ™æ˜¯æ ¸å¿ƒï¼Œæä¾›å¾ˆå¤šçš„apiç»™æˆ‘ä»¬çš„æµ‹è¯•è„šæœ¬è°ƒç”¨ã€‚**


UIè‡ªåŠ¨åŒ–=å®šä½å…ƒç´ +æ“ä½œå…ƒç´ ã€‚



## å…«å¤§å…ƒç´ å®šä½æ–¹å¼

1.  **id**: idå±æ€§ã€‚
2.  **name**: nameå±æ€§ã€‚
éƒ½æ˜¯ç”±å¼€å‘å®šä¹‰çš„ï¼Œé€šå¸¸éƒ½ä¼šå–ä¸ä¸€æ ·çš„åå­—ï¼Œæ‰€ä»¥å®šä½å‡†ç¡®ç‡é«˜ï¼Œå®šä½é€Ÿåº¦å¿«ã€‚å› ä¸ºç”¨çš„æ˜¯cssé€‰æ‹©å™¨çš„éå†æ–¹å¼æ‰¾#idã€‚
3.  **classname**:å…ƒç´ çš„`class`å±æ€§
4.  **tagname**ï¼šå…ƒç´ çš„æ ‡ç­¾åã€‚
é€šå¸¸ä¼šå®šä½åˆ°å¤šä¸ªå…ƒç´ ï¼Œæ‰€ä»¥åŸºæœ¬æ˜¯å’Œfindelementsè¿ä¸€èµ·æ¥ç”¨ã€‚

5.  **linktext**Â : aå…ƒç´ çš„æ–‡æœ¬å†…å®¹ã€‚
6.  **partiallinktext**ï¼š aå…ƒç´ çš„éƒ¨åˆ†æ–‡æœ¬å†…å®¹ã€‚

5ã€6å±€é™æ€§å¤§ï¼Œåªèƒ½ç”¨äºaå…ƒç´ å®šä½ã€‚
### è¿›é˜¶å®šä½æ–¹å¼ï¼š

7.  **xpath**ï¼šæŸ¥è¯¢é€Ÿåº¦æ…¢ã€‚ä½†æ˜¯ å¯¹äºè‚‰çœ¼æ„ŸçŸ¥æ¥è¯´ï¼ŒåŸºæœ¬æ— æ³•æ„ŸçŸ¥ï¼Œ å¤§çº¦æ˜¯ 10~1000msçš„å·®è·ã€‚æ ¹æœ¬æ²¡æœ‰æ„ä¹‰ã€‚

æœ€å¤§ä¼˜åŠ¿ï¼šå¯ä»¥ä½¿ç”¨æ–‡æœ¬å†…å®¹ï¼Œç¨³å®šæ€§å¼ºï¼Œå¹¶ä¸”å¯è¯»æ€§æœ€é«˜ã€‚

8.  **css selector**ï¼š é€Ÿåº¦å¿«ã€‚ è¾ƒé•¿çš„è¡¨è¾¾å¼æ›´ç®€æ´ã€‚

**xpathå’Œcssä¸‡èƒ½ã€‚åªè¦htmlä¸­èƒ½çœ‹åˆ°çš„å…ƒç´ ï¼Œå°±èƒ½å®šä½åˆ°ã€‚Xpathæˆ–cssé€‰æ‹©å™¨å®šä½æ—¶ï¼Œè®°å¾—å…ˆåœ¨æµè§ˆå™¨ä¸­ç”¨å¼€å‘è€…å·¥å…·è¿›è¡Œæ ¡éªŒä¹‹åå†å†™è¿›è„šæœ¬ï¼**
##### css selectoræ¯”xpathæ›´å¿«çš„åŸå› 

å› ä¸ºxpathæ˜¯éå†å…ƒç´ è¿›è¡Œå®šä½ï¼Œcss ç›´æ¥æ˜¯xmlæ ·å¼è¿›è¡Œå®šä½




### **Selenium ä¸­çš„ iframe æ˜¯ä»€ä¹ˆï¼Ÿ**

iframe ä¹Ÿç§°ä¸ºå†…è”æ¡†æ¶ã€‚å®ƒæ˜¯ HTML5 ä¸­ç”¨äºåœ¨çˆ¶ HTML æ–‡æ¡£ä¸­åµŒå…¥ HTML æ–‡æ¡£çš„æ ‡ç­¾ã€‚iframe æ ‡ç­¾æ˜¯ä½¿ç”¨`<iframe></iframe>`æ ‡ç­¾å®šä¹‰çš„ã€‚Â 

### **Selenium ä¸­çš„ frame å’Œ iframe æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

**æ¡†æ¶**ä½¿å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨æ¡†æ¶é›†æ ‡ç­¾æ°´å¹³æˆ–å‚ç›´åˆ†å‰²å±å¹•ã€‚

**æ³¨æ„**ï¼šFrame å’Œ frameset æ ‡è®°å·²è¢«å¼ƒç”¨ï¼Œå› ä¸º HTML 5 ä¸å†æ”¯æŒå®ƒä»¬ã€‚


ä¸ºäº†è®©æµè§ˆå™¨è‡ªåŠ¨å¼€å§‹ä¸ç½‘é¡µäº¤äº’ï¼Œæµè§ˆå™¨å¿…é¡»è¯†åˆ«æ¡†æ¶ä¸‹çš„å…ƒç´ ä»¥è¿›è¡Œ[Selenium æµ‹è¯•](https://www.browserstack.com/automate "è‡ªåŠ¨åŒ–ç¡’æµ‹è¯•")ã€‚Â 

æƒ³è¦å®šä½å…¶ä¸­çš„[iframe]å¹¶åˆ‡è¿›å»ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç ï¼š

é€šå¸¸é‡‡ç”¨idå’Œnameå°±èƒ½å¤Ÿè§£å†³ç»å¤§å¤šæ•°é—®é¢˜ã€‚ä½†æœ‰æ—¶å€™frameå¹¶æ— è¿™ä¸¤é¡¹å±æ€§ï¼Œåˆ™å¯ä»¥ç”¨indexå’ŒWebElementæ¥å®šä½ï¼š

indexä»0å¼€å§‹ï¼Œä¼ å…¥æ•´å‹å‚æ•°å³åˆ¤å®šä¸ºç”¨indexå®šä½ï¼Œä¼ å…¥strå‚æ•°åˆ™åˆ¤å®šä¸ºç”¨id/nameå®šä½
WebElementå¯¹è±¡ï¼Œå³ç”¨find_elementç³»åˆ—æ–¹æ³•æ‰€å–å¾—çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨tag_nameã€xpathç­‰æ¥å®šä½frameå¯¹è±¡


## ç­‰å¾…

åœ¨è¿è¡Œ Selenium æµ‹è¯•æ—¶ï¼Œæµ‹è¯•äººå‘˜é€šå¸¸ä¼šæ”¶åˆ°æ¶ˆæ¯â€œÂ _Element Not Visible Exception_Â â€ã€‚å½“ WebDriver å¿…é¡»ä¸ä¹‹äº¤äº’çš„ç‰¹å®š Web å…ƒç´ çš„åŠ è½½å»¶è¿Ÿæ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚ä¸ºé˜²æ­¢æ­¤å¼‚å¸¸ï¼Œå¿…é¡»ä½¿ç”¨ Selenium ç­‰å¾…å‘½ä»¤ã€‚
åœ¨è‡ªåŠ¨åŒ–æµ‹è¯•ä¸­ï¼Œç­‰å¾…å‘½ä»¤æŒ‡ç¤ºæµ‹è¯•æ‰§è¡Œæš‚åœä¸€æ®µæ—¶é—´ï¼Œç„¶åå†è¿›è¡Œä¸‹ä¸€æ­¥ã€‚è¿™ä½¿ WebDriver èƒ½å¤Ÿæ£€æŸ¥ä¸€ä¸ªæˆ–å¤šä¸ª Web å…ƒç´ æ˜¯å¦å­˜åœ¨/å¯è§/ä¸°å¯Œ/å¯ç‚¹å‡»ç­‰ã€‚

ä½†æ˜¯ï¼Œéšå¼ç­‰å¾…ä¼šå¢åŠ æµ‹è¯•è„šæœ¬çš„æ‰§è¡Œæ—¶é—´ã€‚å®ƒä½¿æ¯ä¸ªå‘½ä»¤åœ¨æ¢å¤æµ‹è¯•æ‰§è¡Œä¹‹å‰ç­‰å¾…å®šä¹‰çš„æ—¶é—´ã€‚å¦‚æœåº”ç”¨ç¨‹åºæ­£å¸¸å“åº”ï¼Œéšå¼ç­‰å¾…ä¼šå‡æ…¢æµ‹è¯•è„šæœ¬çš„æ‰§è¡Œé€Ÿåº¦ã€‚**ä¸“ä¸šæç¤ºï¼š**Â å¦‚æœæ‚¨æ‹…å¿ƒå‡æ…¢ selenium æµ‹è¯•è„šæœ¬çš„é€Ÿåº¦ï¼Œ**[è¯·æŸ¥çœ‹è¿™ 6 ä»¶è¦é¿å…çš„äº‹æƒ…ã€‚](https://www.browserstack.com/guide/things-to-avoid-in-selenium-test-scripts "ç¡’æç¤º")**

ä¸è¦æ··åˆä½¿ç”¨éšå¼å’Œæ˜¾å¼ç­‰å¾…ã€‚è¿™æ ·åšä¼šå¯¼è‡´ä¸å¯é¢„æµ‹çš„ç­‰å¾…æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œå°†éšå¼ç­‰å¾…è®¾ç½®ä¸º10ç§’ï¼Œå°†æ˜¾å¼ç­‰å¾…è®¾ç½®ä¸º15ç§’ï¼Œå¯èƒ½ä¼šå¯¼è‡´åœ¨20ç§’åå‘ç”Ÿè¶…æ—¶ã€‚









# ç”¨ä¾‹è®¾è®¡ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•
é‚£ä¹ˆå­¦äº†è¿™ä¹ˆå¤šçŸ¥è¯†ï¼Œæ˜¯æ—¶å€™å¤§æ˜¾èº«æ‰‹äº†ã€‚<br />è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰çš„æ‰‹å·¥æµ‹è¯•ç”¨ä¾‹å—ï¼Ÿé‚£ä¹ˆï¼Œå†å¼€å§‹ç¼–å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¢³ç†ä¸‹æ€è·¯ï¼Œwebè‡ªåŠ¨åŒ–çš„æµ‹è¯•ç”¨ä¾‹ï¼Œåº”è¯¥é•¿å•¥æ ·å‘¢ï¼Ÿ



é‚£è¿™æ—¶å€™æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ UI è‡ªåŠ¨åŒ–æµ‹è¯•åœºæ™¯ã€‚<br />æ˜¯æˆ‘ä»¬çš„æµ‹è¯•å·¥ç¨‹å¸ˆæ¥é€šè¿‡è¿™ä¸ªç¼–ç¨‹è¯­è¨€å»ç¼–å†™æˆ‘ä»¬è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªè„šæœ¬ã€‚ç„¶åè¿™ä¸ªç¼–ç¨‹è¯­è¨€ä¼šè°ƒç”¨æˆ‘ä»¬çš„seleniumå»æ‰§è¡Œæˆ‘ä»¬è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªè„šæœ¬ã€‚ç„¶åè¿™ä¸ªseleniumæˆ–è€…ç­‰è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒä¼šåœ¨æˆ‘ä»¬çš„è¢«æµ‹ç³»ç»Ÿä¸Šé¢ï¼Œåšä¸€äº›æ¨¡æ‹Ÿç‚¹å‡»æˆ–è€…è¾“å…¥ç­‰ç­‰ç±»å‹æ“ä½œï¼Œç„¶åå¹¶ä¼šè·å–è‡ªåŠ¨åŒ–è¿è¡Œçš„ä¸€ä¸ªå“åº”ç»“æœã€‚<br />é‚£æˆ‘ä»¬æ‹¿åˆ°è¿™ä¸ªç³»ç»Ÿå¯¹åº”çš„å“åº”ç»“æœä¹‹åï¼Œä¼šä¸æˆ‘ä»¬æå‰è®¾å®šå¥½çš„é¢„ä¹ ç»“æœå»åšä¸€ä¸ªå¯¹æ¯”ã€‚<br />é‚£å¦‚æœå¯¹æ¯”ä¸€è‡´çš„è¯ï¼Œå°±è¯æ˜æˆ‘ä»¬çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ç”¨ä¾‹é€šè¿‡äº†ã€‚é‚£å¦‚æœå¯¹æ¯”å¤±è´¥çš„è¯ï¼Œä»£è¡¨çš„æ˜¯æˆ‘ä»¬è‡ªåŠ¨åŒ–æµ‹è¯•çš„ç”¨ä¾‹ä¹Ÿå°±å¤±è´¥äº†ï¼Ÿé‚£è¿™ä¸ªæ˜¯æˆ‘ä»¬ UI è‡ªåŠ¨åŒ–æµ‹è¯•çš„è¿™æ ·çš„ä¸€ä¸ªåœºæ™¯ã€‚


ç„¶åæˆ‘ä»¬æ¥å’Œæ‰‹å·¥ç”¨ä¾‹å¯¹æ¯”ä¸€ä¸‹ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œè§’è‰²æ˜¯å‘ç”Ÿäº†ä¸€äº›å˜åŒ–ï¼Œæ·»åŠ ç¼–ç¨‹è¯­è¨€å’Œseleniumè¿™ä¸¤ä¸ªè§’è‰²ã€‚<br />é‚£åŠ¨ä½œæ˜¯ä»€ä¹ˆï¼ŸåŠ¨ä½œä»¥å‰æ˜¯æµ‹è¯•å·¥ç¨‹å¸ˆåœ¨ç³»ç»Ÿé¡µé¢å¯¹åšç‚¹å‡»è¾“å…¥ç­‰ç­‰ç±»å‹æ“ä½œã€‚é‚£ç°åœ¨æ¢æˆè°ï¼Ÿç°åœ¨æ¢æˆäº†æˆ‘ä»¬çš„ç¼–ç¨‹è¯­è¨€åœ¨åšè¿™ä¸ªäº‹æƒ…ã€‚<br />ç„¶åä»¥å‰æ˜¯æµ‹è¯•å·¥ç¨‹å¸ˆæ‹¿åˆ°å®é™…ç»“æœå’Œé¢„æœŸç»“æœå»åšå¯¹æ¯”ï¼Œé‚£ç°åœ¨ä¹Ÿæ¢æˆäº†ç¼–ç¨‹è¯­è¨€å»åšè¿™ä»¶äº‹æƒ…ã€‚

- ä¸€æ ·

UIè‡ªåŠ¨åŒ–å’ŒåŠŸèƒ½è‡ªåŠ¨åŒ–å’Œè¿™ä¸ªåŠŸèƒ½æµ‹è¯•å®ƒçš„ä¸€ä¸ªè¿‡ç¨‹å…¶å®éƒ½æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œéƒ½æ˜¯åœ¨å¯¹ç³»ç»Ÿé¡µé¢åšç‚¹å‡»ã€è¾“å…¥ç­‰æ“ä½œï¼Œå¹¶ä¸”æ‹¿åˆ°å®é™…ç»“æœå’Œé¢„æœŸç»“æœå»åšå¯¹æ¯”å¯¹å§ï¼Ÿé‚£è¿™ä¸€éƒ¨åˆ†æ˜¯ä»–ä»¬ä¸€æ ·çš„åœ°æ–¹ï¼Œ

- ä¸ä¸€æ ·

é‚£æˆ‘ä»¬æ¥çœ‹ä»–ä»¬ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ä»€ä¹ˆï¼Ÿä»¥å‰æ˜¯ç”±æµ‹è¯•å·¥ç¨‹å¸ˆç›´æ¥å»å¯¹ç³»ç»Ÿå‘èµ·æ“ä½œï¼Œé‚£ç°åœ¨æ¢æˆäº†ç¼–ç¨‹è¯­è¨€ã€‚æ‰€ä»¥è¯´å…¶å® UI è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒåŠŸèƒ½è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä»æœ¬è´¨ä¸Šæ¥è¯´ä»–ä»¬æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è¯´æ“ä½œçš„è§’è‰²ä»æµ‹è¯•å·¥ç¨‹å¸ˆæ¢æˆäº†ç¼–ç¨‹è¯­è¨€å’Œseleniumã€‚

å…¶å®ç†è§£èµ·æ¥ä¹Ÿä¸éš¾å¯¹å§ï¼Œä»¥å‰é æˆ‘ä»¬å°æ‰‹ç‚¹ä¸€ç‚¹ï¼Œç°åœ¨æ¢æˆä»£ç å‘Šè¯‰æµè§ˆå™¨ç‚¹å“ªé‡Œï¼Œè¾“å…¥ä»€ä¹ˆå†…å®¹ï¼Œåˆ¤æ–­ç»“æœæ˜¯å¦åˆ™æ­£ç¡®å¯¹å§ã€‚å› æ­¤ï¼Œæ­¥éª¤ä¸Šå…¶å®æ²¡æœ‰å˜åŒ–ï¼Œè¿˜æ˜¯è¿™äº›æ­¥éª¤ã€‚

```
è‡ªåŠ¨åŒ–åœºæ™¯ï¼šä¼ä¸šå¾®ä¿¡æ·»åŠ æˆå‘˜ï¼ˆwebç«¯ï¼‰

1. ç™»å½•
2. ç‚¹å‡»æ·»åŠ æˆå‘˜æŒ‰é’®
3. å¡«å†™æˆå‘˜ä¿¡æ¯
4. æ–­è¨€ç»“æœ  (è‚‰çœ¼æŸ¥çœ‹ï¼Œå˜æˆäº†assertæ–­è¨€)

```

OKï¼Œé‚£ä¹ˆç°åœ¨å°±åˆ°äº†ç»ƒä¹ æ—¶é—´äº†ã€‚

# å®æˆ˜ç»ƒä¹ 1ï¼ˆ30åˆ†é’Ÿï¼‰

é¢˜ç›®1ï¼šcookieæ¤å…¥ï¼Œä¼ä¸šå¾®ä¿¡ç™»å½•ï¼ˆé¢„å¤‡ï¼‰

å®ç°çš„æ•ˆæœå°±æ˜¯ï¼Œèƒ½å¤Ÿä¿è¯é¦–æ¬¡äººå·¥æ‰«ç ï¼Œç„¶åä¿å­˜cookieåˆ°æœ¬åœ°æ–‡ä»¶ï¼Œæœ€åï¼Œå…¶ä»–çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥ç›´æ¥è¯»å–æœ¬åœ°çš„cookieè¿›è¡Œæ¤å…¥ï¼Œå¹¶ä¸”æˆåŠŸç™»å½•ã€‚






## 1. æ‰«ç å†™å…¥cookie
æ­¥éª¤ï¼š
- 1ã€è®¾ç½®ä¸€ä¸‹å…¨å±€å˜é‡ï¼Œ`Chromedriver`å¦‚æœæ²¡æœ‰é…ç½®å…¨å±€å˜é‡åˆ™ä¼šæŠ¥é”™
- 2ã€æ‰“å¼€Chromeæµè§ˆå™¨
- 3ã€è®¿é—®ä¼ä¸šå¾®ä¿¡ç™»å½•é¡µé¢
- 4ã€æ‰«ç è¿‡ç¨‹
  - æ–¹å¼ä¸€ï¼šå¼ºåˆ¶ç­‰å¾…æ‰«ç 
  - æ–¹å¼äºŒï¼šæ˜¾ç¤ºç­‰å¾…æ‰«ç ï¼Œæ—¶é—´æ›´åŠ çµæ´» 
- 5ã€æ‰«ç å`cookie`ä¿å­˜åˆ°æœ¬åœ°`yaml`æ–‡ä»¶


```java
public class WeWorkAuthBaseTest {

    @Test
    void weWorkTest() {
        /**
         *  java.lang.IllegalStateException:
         *  The path to the driver executable The path to the driver executable must be set by the webdriver.chrome.driver system property;
         */
        //1ã€è®¾ç½®ä¸€ä¸‹å…¨å±€å˜é‡ï¼ŒChromedriverå¦‚æœæ²¡æœ‰é…ç½®å…¨å±€å˜é‡åˆ™ä¼šæŠ¥é”™
        System.setProperty("webdriver.chrome.driver", "driver/chromedriver");
        //2ã€æ‰“å¼€Chromeæµè§ˆå™¨
        WebDriver webDriver = new ChromeDriver();
        //3ã€è®¿é—®ä¼ä¸šå¾®ä¿¡ç™»å½•é¡µé¢
        webDriver.get("https://work.weixin.qq.com/wework_admin/frame#index");

        //4ã€æ‰«ç è¿‡ç¨‹
        //æ–¹å¼ä¸€ï¼šå¼ºåˆ¶ç­‰å¾…æ‰«ç ,æ— è®º10ç§’å†…æ˜¯å¦æ‰«ç æˆåŠŸéƒ½è¦ç­‰å¾…10ç§’
//        try {
//            sleep(10000);
//        } catch (InterruptedException e) {
//            e.printStackTrace();
//        }
        //æ–¹å¼äºŒï¼šæ‰«ç è¿‡ç¨‹
        //æ‰“å¼€æµè§ˆå™¨åç½‘å€å¯èƒ½ä¼šæœ‰è·³è½¬ï¼Œè·å–æœ€æ–°çš„urlåœ°å€
        String url = webDriver.getCurrentUrl();
        WebDriverWait wait = new WebDriverWait(webDriver, Duration.ofMinutes(1));
        //ä¸€æ—¦æ‰«ç å®Œæˆï¼Œurlä¼šè·³è½¬ï¼Œè·³è½¬åè‡ªåŠ¨åœæ­¢ç­‰å¾…å¹¶æ‰§è¡Œåç»­çš„æ“ä½œ
        wait.until(webDriver1 -> !webDriver.getCurrentUrl().equals(url));

        //5ã€æ‰«ç åcookieä¿å­˜
        //è·å–æ‰«ç åçš„cookieå†…å®¹ seté›†åˆæ˜¯ä¸€ä¸ªå…ƒç´ ä¸é‡å¤çš„é›†åˆ
        Set<Cookie> cookies = webDriver.manage().getCookies();
        //æŠŠcookieå†™å…¥æ–‡ä»¶ï¼Œè¿™æ ·ä»€ä¹ˆæ—¶å€™æƒ³å»æ‹¿ç›´æ¥å»æ–‡ä»¶é‡Œé¢æ‹¿ï¼Œä¸éœ€è¦å»æ‰¾è¿™ä¸ªseté›†åˆå¯¹è±¡
        //å†™å…¥yamlæ–‡ä»¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°ç¬¬ä¸‰æ–¹-fasterjson
        ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
        try {
            //è¯»å–æ–‡ä»¶æ˜¯ readValue å†™å…¥æ–‡ä»¶å°±æ˜¯writeValue
            objectMapper.writeValue(Path.of("cookies.yaml").toFile(), cookies);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

## 2. cookieè§£è¯»
- `key`ã€`value`ç»“æ„
- å¯¹åº”æ¯ä¸ªå­—æ®µå«ä¹‰ï¼š
```yaml
- name: "wwrtx.refid" #cookieçš„åç§°
  value: "10349750992271972" #cookieçš„å€¼
  path: "/" #cookieçš„å­˜å‚¨è·¯å¾„
  domain: ".work.weixin.qq.com" #å¯¹åº”åŸŸåè·¯å¾„ï¼Œåªæœ‰ç›¸åŒåŸŸåæ‰ä¼šè¦†ç›–cookieï¼Œå…¶ä»–åŸŸåä¸ä¼šæŠŠcookieå¸¦è¿‡å»
  expiry: null #åˆ°æœŸæ—¶é—´æˆ³
  sameSite: null #åŒä¸€ç«™ç‚¹
  secure: false
  httpOnly: true #åªèƒ½é€šè¿‡httpè®¿é—®
```
## cookieè¯»å–åˆ¤æ–­æ—¶é—´
- 1ã€è¯»å–`cookie`çš„`yaml`æ–‡ä»¶
- 2ã€ä»`cookie`é‡Œé¢è·å–éç©ºçš„æ—¶é—´æˆ³åˆ—è¡¨ï¼Œå¦‚æœæ˜¯`null`åˆ™ä¸éœ€è¦å…³æ³¨
- 3ã€`cookie`ä½¿ç”¨è§„åˆ™
  - é€»è¾‘ï¼šè·å–åˆ°æœŸæ—¶é—´æˆ³
  - ï¼ˆå½“å‰æ—¶é—´æˆ³ - cookieè·å–çš„æ—¶é—´æˆ³ï¼‰ < 7200s ï¼Œå¯ç›´æ¥ä½¿ç”¨`cookie`æ–‡ä»¶
  - æ³¨æ„âš ï¸ï¼šç¬¬ä¸€ä¸ªæ—¶é—´æˆ³ä¸ºcookieè·å–çš„ä¸€å¹´ä»¥åçš„æ—¶é—´æˆ³ï¼Œéœ€è¦è¿›è¡Œè®¡ç®—è½¬æ¢ã€‚
```java
public class WeWorkAuthBaseTest {
  @Test
  public void getCookieYaml() {
    //1ã€è¯»å–cookieçš„yamlæ–‡ä»¶
    ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
    TypeReference<List<HashMap<String, Object>>> typeReference = new TypeReference<List<HashMap<String, Object>>>() {
    };
    List<HashMap<String, Object>> readValue = null;
    try {
      readValue = objectMapper.readValue(Paths.get("cookies.yaml").toFile(), typeReference);
    } catch (IOException e) {
      throw new RuntimeException(e);
    }
    System.out.println(readValue);

    //2ã€ä»cookieé‡Œé¢è·å–æ—¶é—´æˆ³åˆ—è¡¨ nullå€¼å¿½ç•¥
    List<Long> cookieList = new ArrayList<>();
    //è·å–cookieçš„æ—¶é—´
    readValue.forEach(stringObjectHashMap -> {
      if (stringObjectHashMap.get("expiry") != null) {
        Long expiry = Long.valueOf(stringObjectHashMap.get("expiry").toString());
        cookieList.add(expiry);
      }
    });
    //3ã€cookieä½¿ç”¨è§„åˆ™
    //è·å–å½“å‰æ—¶é—´æˆ³
    System.out.println(cookieList);
    long now = System.currentTimeMillis();//1656574451000  1659163447000
    System.out.println((cookieList.get(0) - 31536000000L));//è·å–å½“å‰cookieè·å–çš„æ—¶é—´æˆ³
    System.out.println((now - (cookieList.get(0) - 31536000000L)));
    if ((now - (cookieList.get(0) - 31536000000L)) / 1000 < 7200) {
      System.out.println("ç›´æ¥ä½¿ç”¨cookieæ–‡ä»¶");
    } else {
      System.out.println("æ‰«ç ä¿å­˜cookieæ–‡ä»¶");
    }
  }
}
```



## 3.cookieæ–‡ä»¶è¯»å–ç™»å½•
```java
public class WeWorkAuthBaseTest {
  //cookieæ–‡ä»¶ç™»å½•
  @Test
  public void getCookieLoginTest() {
    /**
     *  java.lang.IllegalStateException:
     *  The path to the driver executable The path to the driver executable must be set by the webdriver.chrome.driver system property;
     */
    //1ã€è®¾ç½®ä¸€ä¸‹å…¨å±€å˜é‡ï¼ŒChromedriverå¦‚æœæ²¡æœ‰é…ç½®å…¨å±€å˜é‡åˆ™ä¼šæŠ¥é”™
    System.setProperty("webdriver.chrome.driver", "driver/chromedriver");
    //2ã€æ‰“å¼€Chromeæµè§ˆå™¨
    WebDriver webDriver = new ChromeDriver();
    //3ã€è®¿é—®ä¼ä¸šå¾®ä¿¡ç™»å½•é¡µé¢
    webDriver.get("https://work.weixin.qq.com/wework_admin/frame#index");

    //æ‰“å¼€æµè§ˆå™¨åç½‘å€å¯èƒ½ä¼šæœ‰è·³è½¬ï¼Œè·å–æœ€æ–°çš„urlåœ°å€
    String url = webDriver.getCurrentUrl();
    //4ã€è¯»å–cookieçš„yamlæ–‡ä»¶
    ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
    TypeReference<List<HashMap<String, Object>>> typeReference = new TypeReference<List<HashMap<String, Object>>>() {
    };
    List<HashMap<String, Object>> readValue = null;
    try {
      readValue = objectMapper.readValue(Paths.get("cookies.yaml").toFile(), typeReference);
    } catch (IOException e) {
      throw new RuntimeException(e);
    }
    System.out.println(readValue);
    readValue.stream()
            //è¿‡æ»¤ä¼ä¸šå¾®ä¿¡çš„cookie
            .filter(cookie -> cookie.get("domain").toString().contains("work.weixin.qq.com"))
            .forEach(cookie -> {
              //å†™cookieåˆ°æµè§ˆå™¨
              webDriver.manage().addCookie(
                      new Cookie(cookie.get("name").toString(), cookie.get("value").toString()));
            });
    //åˆ·æ–°çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šæŠŠæ–°çš„cookieå¸¦åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿”å›ç™»å½•åçš„é¡µé¢
    webDriver.navigate().refresh();

    //cookieæ–‡ä»¶è¿›è¡Œä¼ä¸šå¾®ä¿¡ç™»å½•
    String url2 = webDriver.getCurrentUrl();
    System.out.println(!url2.equals(url) ? "ç™»å½•æˆåŠŸ" : "ç™»å½•å¤±è´¥");

  }
}
```

## ä¼˜åŒ–ä»£ç 
- 1ã€è®¾ç½®ä¸€ä¸‹å…¨å±€å˜é‡ï¼Œ`Chromedriver`å¦‚æœæ²¡æœ‰é…ç½®å…¨å±€å˜é‡åˆ™ä¼šæŠ¥é”™
- 2ã€æ‰“å¼€`Chrome`æµè§ˆå™¨
- 3ã€è®¿é—®ä¼ä¸šå¾®ä¿¡ç™»å½•é¡µé¢
- 4ã€è·å–å½“å‰çš„`url`åœ°å€
- 5ã€`cookie`åˆ¤æ–­
  - `cookie.yaml`æ–‡ä»¶è·å–å¤±æ•ˆæ—¶é—´æˆ³
  - `cookie`è·å–çš„æ—¶é—´æˆ³ï¼šç¬¬1ä¸ªå¤±æ•ˆæ—¶é—´æˆ³ã€Œä¸€å¹´åã€ - 31536000000L
  - ï¼ˆå½“å‰æ—¶é—´æˆ³ - cookieè·å–çš„æ—¶é—´æˆ³ï¼‰ < 7200s 
    - ç›´æ¥ä½¿ç”¨cookieæ–‡ä»¶
    - å¦åˆ™ï¼Œæ‰«ç è·å–cookie
- 6ã€æ‰«ç è¿‡ç¨‹
  - æ–¹å¼ä¸€ï¼šå¼ºåˆ¶ç­‰å¾…æ‰«ç 
  - æ–¹å¼äºŒï¼šæ˜¾ç¤ºç­‰å¾…æ‰«ç ï¼Œæ—¶é—´æ›´åŠ çµæ´»
- 7ã€æ‰«ç å`cookie`ä¿å­˜åˆ°æœ¬åœ°`yaml`æ–‡ä»¶
- 8ã€æ‰«ç åè¦é‡æ–°åŠ è½½`cookie`æ–‡ä»¶
- 9ã€å†™`cookie`åˆ°æµè§ˆå™¨
- 10ã€åˆ·æ–°æµè§ˆå™¨
- 11ã€è·å–æµè§ˆå™¨å½“å‰çš„`URL`
- 12ã€åˆ¤æ–­è¾“å‡ºæ˜¯å¦ç™»å½•æˆåŠŸ

```java
public class WeWorkAuthTest {
    @Test
    public void cookieLoginTest(){
        /**
         *  java.lang.IllegalStateException:
         *  The path to the driver executable The path to the driver executable must be set by the webdriver.chrome.driver system property;
         */
        //1ã€è®¾ç½®ä¸€ä¸‹å…¨å±€å˜é‡ï¼ŒChromedriverå¦‚æœæ²¡æœ‰é…ç½®å…¨å±€å˜é‡åˆ™ä¼šæŠ¥é”™
        System.setProperty("webdriver.chrome.driver","driver/chromedriver");
        //2ã€æ‰“å¼€Chromeæµè§ˆå™¨
        WebDriver webDriver = new ChromeDriver();
        //3ã€è®¿é—®ä¼ä¸šå¾®ä¿¡ç™»å½•é¡µé¢
        webDriver.get("https://work.weixin.qq.com/wework_admin/frame#index");
        
      
        //4ã€æ‰“å¼€æµè§ˆå™¨åç½‘å€å¯èƒ½ä¼šæœ‰è·³è½¬ï¼Œè·å–æœ€æ–°çš„urlåœ°å€
        String url = webDriver.getCurrentUrl();
        //5ã€`cookie`åˆ¤æ–­
        //5.1ã€è·å–cookie.yamlçš„å¤±æ•ˆæ—¶é—´
        List<HashMap<String, Object>> cookies = readCookieYaml();
        List<Long> cookieList = new ArrayList<>();
        //è·å–cookieçš„å¤±æ•ˆæ—¶é—´
        cookies.forEach(cookie -> {
            if(cookie.get("expiry")!=null){
                Long expiry = Long.valueOf(cookie.get("expiry").toString());
                cookieList.add(expiry);
            }
        });

        //cookieè·å–çš„æ—¶é—´æˆ³
        long cookieMills = cookieList.get(0) - 31536000000L;
        //è·å–å½“å‰æ—¶é—´æˆ³
        long now = System.currentTimeMillis();
        if((now - cookieMills)/1000 < 7200){
            System.out.println("ç›´æ¥ä½¿ç”¨cookieæ–‡ä»¶-ä¸éœ€è¦ä¿å­˜cookie");
        }else {
            System.out.println("æ‰«ç ä¿å­˜cookieæ–‡ä»¶");
            //6ã€æ‰«ç è¿‡ç¨‹ 7ã€æ‰«ç å`cookie`ä¿å­˜åˆ°æœ¬åœ°`yaml`æ–‡ä»¶
            saveCookie(webDriver, url);
            //8ã€æ‰«ç åè¦é‡æ–°åŠ è½½`cookie`æ–‡ä»¶
            cookies = readCookieYaml();

        }
        cookies.stream()
                //è¿‡æ»¤ä¼ä¸šå¾®ä¿¡çš„cookie
                .filter(cookie -> cookie.get("domain").toString().contains("work.weixin.qq.com"))
                .forEach(cookie -> {
                    //å†™cookieåˆ°æµè§ˆå™¨
                    webDriver.manage().addCookie(
                            new Cookie(cookie.get("name").toString(), cookie.get("value").toString()));
                });
        //åˆ·æ–°çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šæŠŠæ–°çš„cookieå¸¦åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿”å›ç™»å½•åçš„é¡µé¢
        webDriver.navigate().refresh();

        //cookieæ–‡ä»¶è¿›è¡Œä¼ä¸šå¾®ä¿¡ç™»å½•
        String url2 = webDriver.getCurrentUrl();
        System.out.println(!url2.equals(url)?"ç™»å½•æˆåŠŸ":"ç™»å½•å¤±è´¥");
    }
    private List<HashMap<String, Object>> readCookieYaml() {
        ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
        TypeReference<List<HashMap<String,Object>>> typeReference = new TypeReference<List<HashMap<String, Object>>>() {
        };
        List<HashMap<String, Object>> readValue = null;
        try {
          readValue = objectMapper.readValue(Paths.get("cookies.yaml").toFile(), typeReference);
        } catch (IOException e) {
          throw new RuntimeException(e);
        }
        System.out.println(readValue);
        return readValue;
    }
}
```


# è®²è§£

# å®æˆ˜ç»ƒä¹ 2ï¼ˆ30åˆ†é’Ÿï¼‰

é¢˜ç›®2ï¼šä¼ä¸šå¾®ä¿¡æ·»åŠ æˆå‘˜ï¼ˆçº¿æ€§è„šæœ¬ï¼‰

# è®²è§£

æœ€ç®€å•ä»£ç ï¼š
```java
//ä¼ä¸šå¾®ä¿¡cookieç™»å½•åï¼Œç‚¹å‡»é€šè®¯å½•å…ƒç´   
//1ã€æŸ¥æ‰¾é€šè®¯å½•å…ƒç´  webDriver.findElement(By.å…ƒç´ å®šä½æ–¹å¼())  
WebElement webElement = webDriver.findElement(By.id("menu_contacts"));  
//2ã€é€šè®¯å½•å…ƒç´ æ“ä½œ -- ç‚¹å‡»  
  
webElement.click();  
By addMemberButton = By.linkText("æ·»åŠ æˆå‘˜");  
  
/**  
 * æ·»åŠ æˆå‘˜é¡µé¢æœ‰3ä¸ªï¼Œ2ä¸ªæ˜¾ç¤ºçš„ï¼Œ1ä¸ªæ²¡æœ‰çš„å…ƒç´   
 * 2ä¸ªæ˜¾ç¤ºçš„ï¼šç¬¬1ä¸ªï¼Œæ˜¯æœ€ä¸Šçš„æŒ‰é’®  
 * ç¬¬2ä¸ªå¦‚æœæˆå‘˜è¿‡å¤šï¼Œåˆ™éœ€è¦ç¿»é¡µ  
 */  
//æœ€å¤šç­‰å¾…20ç§’ æ¯éš”2sè½®è¯¢ä¸€æ¬¡ï¼Œè½®è¯¢æ¡ä»¶ä¸ºutil  
WebDriverWait wait = new WebDriverWait(webDriver, Duration.ofSeconds(20), Duration.ofSeconds(2));  
wait.until(ExpectedConditions.visibilityOfElementLocated(addMemberButton));  
webDriver.findElement(addMemberButton).click();  
webDriver.findElement(By.name("username")).sendKeys("202207031533");  
webDriver.findElement(By.name("acctid")).sendKeys("202207031533");  
webDriver.findElement(By.name("biz_mail")).sendKeys(String.valueOf(System.currentTimeMillis()));  
webDriver.findElement(By.name("mobile")).sendKeys("18612725124");  
webDriver.findElement(By.linkText("ä¿å­˜")).click();  
webDriver.navigate().refresh();

```


æˆå‘˜æ•°æ®ï¼ˆå›ºå®šï¼‰
```java
package top.testeru.wechat;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.Cookie;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import java.io.IOException;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.time.Duration;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import static java.lang.Thread.sleep;

/**
 * @program: selenium-sample
 * @author: testeru.top
 * @description: å…ƒç´ ç›¸å…³æ“ä½œ
 * @Version 1.0
 * @create: 2022/6/30 17:56
 */
public class WeWorkTest {
  public static WebDriver webDriver;
  @BeforeAll
  public static void beforeAll(){
    /**
     *  java.lang.IllegalStateException:
     *  The path to the driver executable The path to the driver executable must be set by the webdriver.chrome.driver system property;
     */
    //1ã€è®¾ç½®ä¸€ä¸‹å…¨å±€å˜é‡ï¼ŒChromedriverå¦‚æœæ²¡æœ‰é…ç½®å…¨å±€å˜é‡åˆ™ä¼šæŠ¥é”™
    System.setProperty("webdriver.chrome.driver","driver/chromedriver");
    //2ã€æ‰“å¼€Chromeæµè§ˆå™¨
    webDriver = new ChromeDriver();
  }


  @Test
  public void test(){
    cookieLogin();
    //ä¼ä¸šå¾®ä¿¡cookieç™»å½•åï¼Œç‚¹å‡»é€šè®¯å½•å…ƒç´ 
    //1ã€æŸ¥æ‰¾é€šè®¯å½•å…ƒç´  webDriver.findElement(By.å…ƒç´ å®šä½æ–¹å¼())
    WebElement webElement = webDriver.findElement(By.id("menu_contacts"));
    //2ã€é€šè®¯å½•å…ƒç´ æ“ä½œ -- ç‚¹å‡»

    webElement.click();
    By addMemberButton = By.linkText("æ·»åŠ æˆå‘˜");

    /**
     * æ·»åŠ æˆå‘˜é¡µé¢æœ‰3ä¸ªï¼Œ2ä¸ªæ˜¾ç¤ºçš„ï¼Œ1ä¸ªæ²¡æœ‰çš„å…ƒç´ 
     * 2ä¸ªæ˜¾ç¤ºçš„ï¼šç¬¬1ä¸ªï¼Œæ˜¯æœ€ä¸Šçš„æŒ‰é’®
     * ç¬¬2ä¸ªå¦‚æœæˆå‘˜è¿‡å¤šï¼Œåˆ™éœ€è¦ç¿»é¡µ
     */
    //æœ€å¤šç­‰å¾…20ç§’ æ¯éš”2sè½®è¯¢ä¸€æ¬¡ï¼Œè½®è¯¢æ¡ä»¶ä¸ºutil
    WebDriverWait wait = new WebDriverWait(webDriver, Duration.ofSeconds(20), Duration.ofSeconds(2));
    wait.until(ExpectedConditions.visibilityOfElementLocated(addMemberButton));
    webDriver.findElement(addMemberButton).click();
    webDriver.findElement(By.name("username")).sendKeys("202207031533");
    webDriver.findElement(By.name("acctid")).sendKeys("202207031533");
    webDriver.findElement(By.name("biz_mail")).sendKeys(String.valueOf(System.currentTimeMillis()));
    webDriver.findElement(By.name("mobile")).sendKeys("18612725124");
    webDriver.findElement(By.linkText("ä¿å­˜")).click();
    webDriver.navigate().refresh();
    try {
      sleep(10000);
    } catch (InterruptedException e) {
      throw new RuntimeException(e);
    }


  }


  void cookieLogin(){

    //3ã€è®¿é—®ä¼ä¸šå¾®ä¿¡ç™»å½•é¡µé¢
    //ä½¿ç”¨ HTTP POST æ“ä½œå®Œæˆçš„ï¼Œè¯¥æ–¹æ³•å°†é˜»å¡ï¼Œç›´åˆ°åŠ è½½å®Œæˆ
//        webDriver.navigate().to("https://work.weixin.qq.com/wework_admin/frame#index");
    webDriver.get("https://work.weixin.qq.com/wework_admin/frame#index");
    webDriver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));
    //4ã€æ‰“å¼€æµè§ˆå™¨åç½‘å€å¯èƒ½ä¼šæœ‰è·³è½¬ï¼Œè·å–æœ€æ–°çš„urlåœ°å€
    String url = webDriver.getCurrentUrl();
    //5ã€`cookie`åˆ¤æ–­
    //5.1ã€è·å–cookie.yamlçš„å¤±æ•ˆæ—¶é—´
    List<HashMap<String, Object>> cookies = readCookieYaml();
    List<Long> cookieList = new ArrayList<>();
    //è·å–cookieçš„å¤±æ•ˆæ—¶é—´
    cookies.forEach(cookie -> {
      if(cookie.get("expiry")!=null){
        Long expiry = Long.valueOf(cookie.get("expiry").toString());
        cookieList.add(expiry);
      }
    });

    //cookieè·å–çš„æ—¶é—´æˆ³
    long cookieMills = cookieList.get(0) - 31536000000L;
    //è·å–å½“å‰æ—¶é—´æˆ³
    long now = System.currentTimeMillis();
    if((now - cookieMills)/1000 < 7200){
      System.out.println("ç›´æ¥ä½¿ç”¨cookieæ–‡ä»¶-ä¸éœ€è¦ä¿å­˜cookie");
    }else {
      System.out.println("æ‰«ç ä¿å­˜cookieæ–‡ä»¶");
      //6ã€æ‰«ç è¿‡ç¨‹ 7ã€æ‰«ç å`cookie`ä¿å­˜åˆ°æœ¬åœ°`yaml`æ–‡ä»¶
      saveCookie(webDriver, url);
      //8ã€æ‰«ç åè¦é‡æ–°åŠ è½½`cookie`æ–‡ä»¶
      cookies = readCookieYaml();

    }
    cookies.stream()
            //è¿‡æ»¤ä¼ä¸šå¾®ä¿¡çš„cookie
            .filter(cookie -> cookie.get("domain").toString().contains("work.weixin.qq.com"))
            .forEach(cookie -> {
              //å†™cookieåˆ°æµè§ˆå™¨
              webDriver.manage().addCookie(
                      new Cookie(cookie.get("name").toString(), cookie.get("value").toString()));
            });
    //åˆ·æ–°çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šæŠŠæ–°çš„cookieå¸¦åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿”å›ç™»å½•åçš„é¡µé¢
    webDriver.navigate().refresh();
    //cookieæ–‡ä»¶è¿›è¡Œä¼ä¸šå¾®ä¿¡ç™»å½•
    String url2 = webDriver.getCurrentUrl();
    System.out.println(!url2.equals(url)?"ç™»å½•æˆåŠŸ":"ç™»å½•å¤±è´¥");
  }


  private List<HashMap<String, Object>> readCookieYaml() {
    ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
    TypeReference<List<HashMap<String,Object>>> typeReference = new TypeReference<List<HashMap<String, Object>>>() {
    };
    List<HashMap<String, Object>> readValue = null;
    try {
      readValue = objectMapper.readValue(Paths.get("cookies.yaml").toFile(), typeReference);
    } catch (IOException e) {
      throw new RuntimeException(e);
    }
    System.out.println(readValue);
    return readValue;
  }
  private void saveCookie(WebDriver webDriver, String url) {

    //4ã€æ‰«ç è¿‡ç¨‹
    //æ–¹å¼ä¸€ï¼šå¼ºåˆ¶ç­‰å¾…æ‰«ç ,æ— è®º10ç§’å†…æ˜¯å¦æ‰«ç æˆåŠŸéƒ½è¦ç­‰å¾…10ç§’
//        try {
//            sleep(10000);
//        } catch (InterruptedException e) {
//            e.printStackTrace();
//        }
//        //æ–¹å¼äºŒï¼šæ‰«ç è¿‡ç¨‹
    WebDriverWait wait = new WebDriverWait(webDriver, Duration.ofMinutes(1));
    //ä¸€æ—¦æ‰«ç å®Œæˆï¼Œurlä¼šè·³è½¬ï¼Œè·³è½¬åè‡ªåŠ¨åœæ­¢ç­‰å¾…å¹¶æ‰§è¡Œåç»­çš„æ“ä½œ
    wait.until(webDriver1 -> !webDriver.getCurrentUrl().equals(url));
    //5ã€æ‰«ç åcookieä¿å­˜
    //è·å–æ‰«ç åçš„cookieå†…å®¹ seté›†åˆæ˜¯ä¸€ä¸ªå…ƒç´ ä¸é‡å¤çš„é›†åˆ
    Set<Cookie> cookies = webDriver.manage().getCookies();
    //æŠŠcookieå†™å…¥æ–‡ä»¶ï¼Œè¿™æ ·ä»€ä¹ˆæ—¶å€™æƒ³å»æ‹¿ç›´æ¥å»æ–‡ä»¶é‡Œé¢æ‹¿ï¼Œä¸éœ€è¦å»æ‰¾è¿™ä¸ªseté›†åˆå¯¹è±¡
    //å†™å…¥yamlæ–‡ä»¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°ç¬¬ä¸‰æ–¹-fasterjson
    ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
    try {
      //è¯»å–æ–‡ä»¶æ˜¯ readValue å†™å…¥æ–‡ä»¶å°±æ˜¯writeValue
      objectMapper.writeValue(Path.of("cookies.yaml").toFile(),cookies);
    } catch (IOException e) {
      e.printStackTrace();
    }
  }
}
```

- ä¼˜åŒ–ï¼šä½¿ç”¨fakeré€ æµ‹è¯•æ•°æ®


ç”¨æ³•ï¼š
```python
# å®ä¾‹åŒ–
fake = Faker('zh_CN')

fake.name()
fake.ssn()
fake.phone_number()
```



æŠ€å·§ï¼šå†’æ³¡æ¶ˆæ¯è°ƒè¯•<br />F12/Sources

é—®å¤§å®¶ä¸€ä¸ªé—®é¢˜ï¼Œç›®å‰æˆ‘ä»¬åšçš„è¶³å¤Ÿå®Œç¾å—ï¼Ÿ
# ç—›ç‚¹åˆ†æ

- å¤§æ®µé‡å¤ä»£ç 
- æ— æ³•é€‚åº”UIçš„å˜åŒ–

```java
package top.testeru.wechat;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.Cookie;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import top.testeru.utils.FakerUtil;

import java.io.IOException;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.time.Duration;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Set;

import static java.lang.Thread.sleep;
import static org.junit.jupiter.api.Assertions.assertEquals;

/**
 * @program: selenium-sample
 * @author: testeru.top
 * @description: å…ƒç´ ç›¸å…³æ“ä½œ
 * @Version 1.0
 * @create: 2022/6/30 17:56
 */
public class WeWorkRandomTest {
    public static WebDriver webDriver;
    @BeforeAll
    public static void beforeAll(){
        /**
         *  java.lang.IllegalStateException:
         *  The path to the driver executable The path to the driver executable must be set by the webdriver.chrome.driver system property;
         */
        //1ã€è®¾ç½®ä¸€ä¸‹å…¨å±€å˜é‡ï¼ŒChromedriverå¦‚æœæ²¡æœ‰é…ç½®å…¨å±€å˜é‡åˆ™ä¼šæŠ¥é”™
        System.setProperty("webdriver.chrome.driver","driver/chromedriver");
        //2ã€æ‰“å¼€Chromeæµè§ˆå™¨
        webDriver = new ChromeDriver();
    }


    @Test
    public void test(){
        cookieLogin();
        //ä¼ä¸šå¾®ä¿¡cookieç™»å½•åï¼Œç‚¹å‡»é€šè®¯å½•å…ƒç´ 
        //1ã€æŸ¥æ‰¾é€šè®¯å½•å…ƒç´  webDriver.findElement(By.å…ƒç´ å®šä½æ–¹å¼())
        WebElement webElement = webDriver.findElement(By.id("menu_contacts"));
        //2ã€é€šè®¯å½•å…ƒç´ æ“ä½œ -- ç‚¹å‡»

        webElement.click();
        By addMemberButton = By.linkText("æ·»åŠ æˆå‘˜");

        /**
         * æ·»åŠ æˆå‘˜é¡µé¢æœ‰3ä¸ªï¼Œ2ä¸ªæ˜¾ç¤ºçš„ï¼Œ1ä¸ªæ²¡æœ‰çš„å…ƒç´ 
         * 2ä¸ªæ˜¾ç¤ºçš„ï¼šç¬¬1ä¸ªï¼Œæ˜¯æœ€ä¸Šçš„æŒ‰é’®
         * ç¬¬2ä¸ªå¦‚æœæˆå‘˜è¿‡å¤šï¼Œåˆ™éœ€è¦ç¿»é¡µ
         */
        //æœ€å¤šç­‰å¾…20ç§’ æ¯éš”2sè½®è¯¢ä¸€æ¬¡ï¼Œè½®è¯¢æ¡ä»¶ä¸ºutil
        WebDriverWait wait = new WebDriverWait(webDriver, Duration.ofSeconds(20), Duration.ofSeconds(2));
        wait.until(ExpectedConditions.visibilityOfElementLocated(addMemberButton));
        webDriver.findElement(addMemberButton).click();
        String name = FakerUtil.get_name();
        String phone = "186" + FakerUtil.get_phone();
        webDriver.findElement(By.name("username")).sendKeys(name);
        webDriver.findElement(By.name("acctid")).sendKeys(String.valueOf(System.currentTimeMillis()));
        webDriver.findElement(By.name("biz_mail")).sendKeys(String.valueOf(System.currentTimeMillis()));
        webDriver.findElement(By.name("mobile")).sendKeys(phone);

        webDriver.findElement(By.linkText("ä¿å­˜")).click();
        webDriver.navigate().refresh();
        By memberSearchInput = By.id("memberSearchInput");
        webDriver.findElement(memberSearchInput).sendKeys(name);
        String searchName = webDriver.findElement(
                By.cssSelector(".member_display_cover_detail_name")).getText();
        String searchMobile=webDriver.findElement(
                By.cssSelector(".member_display_item_Phone .member_display_item_right")).getText();
        assertEquals(searchName, name);
        assertEquals(searchMobile, phone);

    }


    void cookieLogin(){

        //3ã€è®¿é—®ä¼ä¸šå¾®ä¿¡ç™»å½•é¡µé¢
        //ä½¿ç”¨ HTTP POST æ“ä½œå®Œæˆçš„ï¼Œè¯¥æ–¹æ³•å°†é˜»å¡ï¼Œç›´åˆ°åŠ è½½å®Œæˆ
//        webDriver.navigate().to("https://work.weixin.qq.com/wework_admin/frame#index");
        webDriver.get("https://work.weixin.qq.com/wework_admin/frame#index");
        webDriver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));
        //4ã€æ‰“å¼€æµè§ˆå™¨åç½‘å€å¯èƒ½ä¼šæœ‰è·³è½¬ï¼Œè·å–æœ€æ–°çš„urlåœ°å€
        String url = webDriver.getCurrentUrl();
        //5ã€`cookie`åˆ¤æ–­
        //5.1ã€è·å–cookie.yamlçš„å¤±æ•ˆæ—¶é—´
        List<HashMap<String, Object>> cookies = readCookieYaml();
        List<Long> cookieList = new ArrayList<>();
        //è·å–cookieçš„å¤±æ•ˆæ—¶é—´
        cookies.forEach(cookie -> {
            if(cookie.get("expiry")!=null){
                Long expiry = Long.valueOf(cookie.get("expiry").toString());
                cookieList.add(expiry);
            }
        });

        //cookieè·å–çš„æ—¶é—´æˆ³
        long cookieMills = cookieList.get(0) - 31536000000L;
        //è·å–å½“å‰æ—¶é—´æˆ³
        long now = System.currentTimeMillis();
        if((now - cookieMills)/1000 < 7200){
            System.out.println("ç›´æ¥ä½¿ç”¨cookieæ–‡ä»¶-ä¸éœ€è¦ä¿å­˜cookie");
        }else {
            System.out.println("æ‰«ç ä¿å­˜cookieæ–‡ä»¶");
            //6ã€æ‰«ç è¿‡ç¨‹ 7ã€æ‰«ç å`cookie`ä¿å­˜åˆ°æœ¬åœ°`yaml`æ–‡ä»¶
            saveCookie(webDriver, url);
            //8ã€æ‰«ç åè¦é‡æ–°åŠ è½½`cookie`æ–‡ä»¶
            cookies = readCookieYaml();

        }
        cookies.stream()
                //è¿‡æ»¤ä¼ä¸šå¾®ä¿¡çš„cookie
                .filter(cookie -> cookie.get("domain").toString().contains("work.weixin.qq.com"))
                .forEach(cookie -> {
                    //å†™cookieåˆ°æµè§ˆå™¨
                    webDriver.manage().addCookie(
                            new Cookie(cookie.get("name").toString(), cookie.get("value").toString()));
                });
        //åˆ·æ–°çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šæŠŠæ–°çš„cookieå¸¦åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿”å›ç™»å½•åçš„é¡µé¢
        webDriver.navigate().refresh();
        //cookieæ–‡ä»¶è¿›è¡Œä¼ä¸šå¾®ä¿¡ç™»å½•
        String url2 = webDriver.getCurrentUrl();
        System.out.println(!url2.equals(url)?"ç™»å½•æˆåŠŸ":"ç™»å½•å¤±è´¥");
    }


    private List<HashMap<String, Object>> readCookieYaml() {
        ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
        TypeReference<List<HashMap<String,Object>>> typeReference = new TypeReference<List<HashMap<String, Object>>>() {
        };
        List<HashMap<String, Object>> readValue = null;
        try {
            readValue = objectMapper.readValue(Paths.get("cookies.yaml").toFile(), typeReference);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
        System.out.println(readValue);
        return readValue;
    }
    private void saveCookie(WebDriver webDriver, String url) {

        //4ã€æ‰«ç è¿‡ç¨‹
        //æ–¹å¼ä¸€ï¼šå¼ºåˆ¶ç­‰å¾…æ‰«ç ,æ— è®º10ç§’å†…æ˜¯å¦æ‰«ç æˆåŠŸéƒ½è¦ç­‰å¾…10ç§’
//        try {
//            sleep(10000);
//        } catch (InterruptedException e) {
//            e.printStackTrace();
//        }
//        //æ–¹å¼äºŒï¼šæ‰«ç è¿‡ç¨‹
        WebDriverWait wait = new WebDriverWait(webDriver, Duration.ofMinutes(1));
        //ä¸€æ—¦æ‰«ç å®Œæˆï¼Œurlä¼šè·³è½¬ï¼Œè·³è½¬åè‡ªåŠ¨åœæ­¢ç­‰å¾…å¹¶æ‰§è¡Œåç»­çš„æ“ä½œ
        wait.until(webDriver1 -> !webDriver.getCurrentUrl().equals(url));
        //5ã€æ‰«ç åcookieä¿å­˜
        //è·å–æ‰«ç åçš„cookieå†…å®¹ seté›†åˆæ˜¯ä¸€ä¸ªå…ƒç´ ä¸é‡å¤çš„é›†åˆ
        Set<Cookie> cookies = webDriver.manage().getCookies();
        //æŠŠcookieå†™å…¥æ–‡ä»¶ï¼Œè¿™æ ·ä»€ä¹ˆæ—¶å€™æƒ³å»æ‹¿ç›´æ¥å»æ–‡ä»¶é‡Œé¢æ‹¿ï¼Œä¸éœ€è¦å»æ‰¾è¿™ä¸ªseté›†åˆå¯¹è±¡
        //å†™å…¥yamlæ–‡ä»¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°ç¬¬ä¸‰æ–¹-fasterjson
        ObjectMapper objectMapper = new ObjectMapper(new YAMLFactory());
        try {
            //è¯»å–æ–‡ä»¶æ˜¯ readValue å†™å…¥æ–‡ä»¶å°±æ˜¯writeValue
            objectMapper.writeValue(Path.of("cookies.yaml").toFile(),cookies);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

```
# è¯¾åä½œä¸š

- ç™»å½•æˆåŠŸåï¼Œè¿›å…¥é€šè®¯å½•é¡µé¢ï¼Œå®Œæˆæ·»åŠ æˆå‘˜çš„è‡ªåŠ¨åŒ–æ“ä½œ
- å®Œæˆæ·»åŠ éƒ¨é—¨çš„è‡ªåŠ¨åŒ–æ“ä½œ


# ç»“æŸè¯­
æœ€åçš„æœ€åï¼Œå¸Œæœ›æ¯ä½åŒå­¦è®¤çœŸå¤ä¹ ï¼Œè®¤çœŸåšç¬”è®°ã€‚


---

å¥½çš„ï¼Œå¿«ä¹çš„æ—¶å…‰æ€»æ˜¯è¿‡å¾—é£å¿«ï¼Œåˆè¦åˆ°äº†è¯´å†è§çš„æ—¶å€™äº†ã€‚

æœ€åï¼Œéå¸¸æ„Ÿè°¢ä»Šå¤©çš„**åŠ©æ•™è€å¸ˆ**ï¼Œä¹Ÿéå¸¸æ„Ÿè°¢çº¿ä¸Šçš„æ¯ä¸€ä½**åŒå­¦**çš„æ”¯æŒï¼Œå¤§å®¶çš„å‹¤å¥‹å’ŒåŠªåŠ›éå¸¸å®è´µï¼Œå¸Œæœ›å¤§å®¶å†æ¥å†å‰ï¼Œå‹‡æ”€é«˜å³°ã€‚

æˆ‘æ˜¯éœæ ¼æ²ƒå…¹çš„ç™¾é‡Œï¼Œ5æœˆ15å·çš„ç¬¬äºŒèŠ‚è®­ç»ƒè¥ï¼Œæˆ‘ä»¬ä¸è§ä¸æ•£ï¼

ğŸ‘‹    åŒå­¦ä»¬ï¼Œæ‹œæ‹œï¼


