---
tags: note
status: todo
priority: 1
time: 2022-05-30 11:29
things:  "[🧊](things:///show?id=JtkDsmtmq6Bd8ZbzKBJTW4)"
---
# 等待
## 强制等待
```java
import static java.lang.Thread.sleep;

try {
  sleep(2000);
} catch (InterruptedException e) {
  e.printStackTrace();
}
```

## 隐式等待

设置等待时间，是对页面中的所有元素设置加载时间，如果超出了设置时间的则抛出异常。隐式等待可以理解成在规定的时间范围内，浏览器在不停的刷新页面，直到找到相关元素或者时间结束。

- [I] 隐式等待用于告诉 `driver` 驱动程序在抛出`No Such Element Exception`之前等待一段时间
- [I] 默认设置为 0
- [i] 设置了隐式等待的时间，`driver` 驱动程序将在抛出异常之前 元素的等待该时间


- [p] 声明了一个时间范围为 5 秒的隐式等待，意味着如果该元素在该时间范围内不在页面上，它将抛出异常

```java
driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));
```
原理：隐式等待，就是在创建driver时，为浏览器对象创建一个等待时间，这个方法是得不到某个元素就等待一段时间，直到拿到某个元素位置。

注意：在使用隐式等待的时候，实际上浏览器会在你自己设定的时间内部断的刷新页面去寻找我们需要的元素

implicity_wait()默认参数的单位为妙，本例中设置等待时长为10秒，
首先这10秒并非一个固定的等待时间，它并不影响脚本的执行速度。
其次，它并不针对页面上的某一元素进行等待。
当脚本执行到某个元素定位是，如果元素可以定位，则继续执行，如果元素定位不到，则它将以轮询的方式不断地判断元素是否被定位到。
假设在第六秒定位到了元素则继续执行，若直到超出设置的时长10秒还没有定位到元素，则抛出异常。

## 显示等待
显示等待，是针对于某个特定的元素设置的等待时间，在设置时间内，默认每隔一段时间检测一次当前页面某个元素是否存在，如果在规定的时间内找到了元素，则直接执行，即找到元素就执行相关操作，如果超过设置时间检测不到则抛出异常。默认检测频率为0.5s，默认抛出异常为：NoSuchElementException

显示等待，就是明确的要等到某个元素的出现或者是某个元素的可点击等条件，等不到，就一直等，除非在规定的时间之内都没找到，那么久跳出Exception

(简而言之，**就是直到元素出现才去操作**，如果超时则报异常)

  原理：显示等待，就是明确的要等到某个元素的出现或者是某个元素的可点击等条件，等不到，就一直等，除非在规定的时间之内都没找到，那么久跳出Exception  
(简而言之，就是直到元素出现才去操作，如果超时则报异常)

### WebDriverWait
### FluentWait

##### 什么时候用？
- [f] 设置查找元素的总等待时长
- [f] 设置每隔多久查找一次
- [f] 设置忽略某些特定异常 

>页面的元素有时在几秒钟内可见、有时需要更长的时间才能可见时，我们可以使用此等待命令。


- [b] 尝试以固定的时间间隔重复查找 Web 元素，并且忽略某些特定异常，直到超时或找到对象

- 
```java
FluentWait fluentWait = new FluentWait(driver)
                        //设置等待评估条件为真的时间 ---超时值
                        .withTimeout(Duration.ofSeconds(45))
                        //设置评估条件的频率 ---轮询频率
                        .pollingEvery(Duration.ofSeconds(5))
                        //忽略特定类型的异常
                        .ignoring(NoSuchElementException.class);
```    

>超时值设为 45 秒，将轮询频率设为 5 秒。
> 等待条件的最长时间（45 秒）和检查指定条件成功或失败的频率（5 秒）
> 如果元素位于此时间范围内，它将执行操作，否则将抛出 ElementNotVisibleException




**哪个等待更好？**

自动化的最佳实践是尝试始终减少自动化时间。为此，我们应该始终使用一个在找到 Web 元素后从不浪费时间的命令。我们应该使用隐式等待，这是一个应用于页面上所有 Web 元素的全局等待。隐式等待的默认值为 0。

对于任何具有某些条件的 Web 元素，我们都可以使用显式等待。



**Selenium 中有哪些不同类型的等待命令？**

selenium 中有不同类型的等待。

1.  [静态等待](https://www.lambdatest.com/blog/types-of-waits-in-selenium/#:~:text=Selenium%20Webdriver%20waits%20for%20the,execution%20time%20of%20the%20script.)
2.  隐式等待
3.  显式等待
4.  流畅的等待





**隐式等待显式等待和流畅等待有什么区别？**

**隐式等待**

隐式等待时间应用于所有元素。

无需指定任何等待条件。

**显式等待**

显式等待仅应用于我们给出的一个元素。

在继续编写代码之前，我们需要为该 Web 元素指定一个条件。

**流利的等待**

我们需要在此提供轮询时间。轮询时间是检查特定元素的频率时间。

我们可以指定忽略它的异常。




  

|隐式等待|显式等待|
|---|---|
|隐式等待时间应用于脚本中的所有元素|显式等待时间仅适用于我们预期的那些元素|
|隐式等待中，我们不需要在要定位的元素上指定“ExpectedConditions”|显式等待中，我们需要在要定位的元素上指定“ExpectedConditions”|
|在元素位于 Selenium 隐式等待中指定的时间范围内时使用|在元素加载时间较长以及验证元素属性时使用（visibilityOfElementLocated, elementToBeClickable,elementToBeSelected）|