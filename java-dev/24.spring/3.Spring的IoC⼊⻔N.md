---
tags: note
status: done
priority: 1
time: 2022-05-24 17:36
things:  "[ğŸ§Š](things:///show?id=JtkDsmtmq6Bd8ZbzKBJTW4)"
---


# Springçš„IoCâ¼Šâ»”

## æ¡ˆä¾‹çš„å‰ç½®è¯´æ˜

åœ¨ä½¿â½¤ `Spring` ä¸­`IoC`çš„é…ç½®æ—¶ï¼Œå®ƒâ½€æŒ==çº¯`XML`é…ç½®==æˆ–è€…==çº¯æ³¨è§£é…ç½®==ä»¥åŠ==XMLå’Œæ³¨è§£æ··åˆé…ç½®==è¿™ä¸‰ç§â½…å¼ã€‚

## å‰æœŸå‡†å¤‡â¼¯ä½œ(â¼Šâ»”æ¡ˆä¾‹)

æœ¬æ¡ˆä¾‹è¦è§£å†³ è´¦æˆ·çš„ä¸šåŠ¡å±‚å’ŒæŒä¹…å±‚çš„ä¾èµ–å…³ç³»ã€‚
>åœ¨å¼€å§‹ spring çš„é…ç½®ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆå‡†å¤‡â¼€ä¸‹ç¯å¢ƒã€‚
>ç”±äºæˆ‘ä»¬æ˜¯ä½¿â½¤ spring è§£å†³ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„è¦åšå¢åˆ æ”¹æŸ¥æ“ä½œï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬æ²¡å¿…è¦å†™å®ä½“ç±»ã€‚å¹¶ä¸”æˆ‘ä»¬åœ¨æ­¤å¤„ä½¿â½¤çš„æ˜¯ java â¼¯ç¨‹ï¼Œä¸æ˜¯java web â¼¯ç¨‹ã€‚
#### æŒä¹…å±‚
æ­¥éª¤1: åˆ›å»ºæŒä¹…å±‚æ¥â¼å’Œå®ç°ç±»
```java
public interface AccountDao {
    //æ¨¡æ‹Ÿä¿å­˜è´¦æˆ·
    void saveAccount();
}
```


```java
public class AccountDaoImpl implements AccountDao {
    @Override
    public void saveAccount() {
        System.out.println("ä¿å­˜äº†è´¦æˆ·");
    }
}
```
#### ä¸šåŠ¡å±‚

æ­¥éª¤2: åˆ›å»ºä¸šåŠ¡å±‚æ¥â¼å’Œå®ç°ç±»

```java
public interface AccountService {
    //ä¿å­˜è´¦æˆ·
    void saveAccount();
}
```



```java
public class AccountServiceImpl implements AccountService {

    //å­˜åœ¨ä»£ç è€¦åˆçš„é—®é¢˜
    AccountDao accountDao = new AccountDaoImpl();
    @Override
    public void saveAccount() {
        //è°ƒç”¨daoå±‚çš„ä¿å­˜è´¦æˆ·æ–¹æ³•
        accountDao.saveAccount();
    }
}
```


## SpringåŸºäºXMLçš„çš„é…ç½®(â¼Šâ»”æ¡ˆä¾‹)
#### pomå¯¼åŒ…
æ­¥éª¤1: å¯¼â¼ŠjaråŒ…ä¾èµ– pom.xml
```xml
<dependencies>
    <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter-api</artifactId>
        <version>5.8.2</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>5.3.19</version>
    </dependency>
</dependencies>
```
#### beansé…ç½®æ–‡ä»¶
æ­¥éª¤2: åˆ›å»ºSpringçš„é…ç½®â½‚ä»¶ beans.xml (â½‚ä»¶åå¯ä»»æ„èµ·å)
![](https://cdn.jsdelivr.net/gh/testeru-top/images/springboot202205231111334.png)
>pomæ–‡ä»¶å¯¼å…¥æˆåŠŸåï¼Œå¯¹åº”çš„åˆ›å»ºé…ç½®æ–‡ä»¶æ—¶ä¼šæœ‰Spring Configé€‰é¡¹ã€‚

[Beané…ç½®](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-introduction)

- è®©Springç®¡ç†èµ„æº, åœ¨é…ç½®â½‚ä»¶ä¸­é…ç½®service
```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd">
<!--    idï¼šæ ‡è¯†å•ä¸ª bean å®šä¹‰çš„å­—ç¬¦ä¸²
        classï¼šå®šä¹‰ bean çš„ç±»å‹å¹¶ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»å-->
    <bean id="accountService" class="top.testeru.service.impl.AccountServiceImpl">
        <!-- collaborators and configuration for this bean go here -->
    </bean>


    <!-- more bean definitions go here -->

</beans>
```

- idï¼šæ ‡è¯†å•ä¸ª bean å®šä¹‰çš„å­—ç¬¦ä¸²
- classï¼šå®šä¹‰ bean çš„ç±»å‹å¹¶ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»å


#### æµ‹è¯•
æ­¥éª¤2: æµ‹è¯•é…ç½®æ˜¯å¦æˆåŠŸ

```java
package top.testeru.dao.impl;

import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import top.testeru.service.AccountService;
import top.testeru.service.impl.AccountServiceImpl;

import static org.junit.jupiter.api.Assertions.*;

/**
 * @Classname AccountDaoImplTest
 * @Description IOCçš„æµ‹è¯•ç±»
 * @Date 2022/5/23 11:20
 * @Created by top.testeru
 */
class AccountDaoImplTest {

    /**
     * è·å–Springå®¹å™¨ä¸­çš„ serviceå¯¹è±¡
     */
    @Test
    public void iocTest(){
        /**
         * é€šè¿‡Springæ¡†æ¶åŠ è½½XMLé…ç½®â½‚ä»¶
         * è§£æbeans.xmlé…ç½®â½‚ä»¶ æŠŠBeanæ ‡ç­¾ä¸­çš„id ä¸classå±æ€§å€¼, å­˜åˆ°Mapé›†åˆä¸­
         * è¿™ä¸ªMapé›†åˆæ˜¯ç”±Springæ¡†æ¶ç»´æŠ¤çš„, æŠŠè¿™ä¸ªMAPé›†åˆ æˆä¸º Springå®¹å™¨
         */
        //1.åŠ è½½Springçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ å¤šä¸ªé…ç½®æ–‡ä»¶é€—å·éš”å¼€
        //æä¾›ç»™æ„é€ å‡½æ•°çš„ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®è·¯å¾„ApplicationContextæ˜¯èµ„æºå­—ç¬¦ä¸²ï¼Œå…è®¸å®¹å™¨ä»å„ç§å¤–éƒ¨èµ„æºï¼ˆä¾‹å¦‚æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€Java ç­‰ï¼‰åŠ è½½é…ç½®å…ƒæ•°æ®CLASSPATHã€‚
        ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
        AccountService accountService = (AccountService)context.getBean("accountService");
        accountService.saveAccount();
    }
}
```
![testend](https://cdn.jsdelivr.net/gh/testeru-top/images/spring/202205231143836.png)

## Bean


Bean æ˜¯ Spring Framework çš„ä¸€ä¸ªå…³é”®æ¦‚å¿µã€‚å› æ­¤ï¼Œç†è§£è¿™ä¸ªæ¦‚å¿µå¯¹äºæŒæ¡æ¡†æ¶å¹¶ä»¥æœ‰æ•ˆçš„æ–¹å¼ä½¿ç”¨å®ƒè‡³å…³é‡è¦ã€‚

ä¸å¹¸çš„æ˜¯ï¼Œå¯¹äº Spring bean åˆ°åº•æ˜¯ä»€ä¹ˆè¿™ä¸ªç®€å•çš„é—®é¢˜ï¼Œå¹¶æ²¡æœ‰æ˜ç¡®çš„ç­”æ¡ˆã€‚ä¸€äº›è§£é‡Šå¤ªä½äº†ä»¥è‡³äºé”™è¿‡äº†å¤§å±€ï¼Œè€Œå¦ä¸€äº›è§£é‡Šå¤ªæ¨¡ç³Šäº†ã€‚

### ä»€ä¹ˆæ˜¯Beanï¼Ÿ

[è¿™æ˜¯Spring Framework æ–‡æ¡£](https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#beans-introduction)ä¸­ bean çš„å®šä¹‰Â ï¼š

_åœ¨ Spring ä¸­ï¼Œæ„æˆåº”ç”¨ç¨‹åºä¸»å¹²å¹¶ç”± Spring IoC å®¹å™¨ç®¡ç†çš„å¯¹è±¡ç§°ä¸º beanã€‚bean æ˜¯ç”± Spring IoC å®¹å™¨å®ä¾‹åŒ–ã€ç»„è£…å’Œç®¡ç†çš„å¯¹è±¡ã€‚_

>è¿™ä¸ªå®šä¹‰ç®€æ´æ˜äº†ï¼Œ**ä½†æ²¡æœ‰è¯¦ç»†è¯´æ˜ä¸€ä¸ªé‡è¦å…ƒç´ ï¼šSpring IoC å®¹å™¨ã€‚**è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆä»¥åŠå®ƒå¸¦æ¥çš„å¥½å¤„ã€‚

ç®€å•åœ°è¯´ï¼Œ[æ§åˆ¶](https://www.baeldung.com/inversion-control-and-dependency-injection-in-spring)[åè½¬](https://www.baeldung.com/inversion-control-and-dependency-injection-in-spring)(IoC) æ˜¯**ä¸€ä¸ªå¯¹è±¡å®šä¹‰å…¶ä¾èµ–å…³ç³»è€Œä¸åˆ›å»ºå®ƒä»¬çš„è¿‡ç¨‹ã€‚**è¯¥å¯¹è±¡å°†æ„å»ºæ­¤ç±»ä¾èµ–é¡¹çš„å·¥ä½œå§”æ‰˜ç»™ IoC å®¹å™¨ã€‚